MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE  1


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00001 ; +-----------------------------------------------------------------------------------------------------
                            ------------------------+
                      00002 ; | Gestion de 24 servos avec un PIC18F452                                                              
                                                                                                                            
                      00003 ; | Copyright (C) 2012 Charles RINCHEVAL (contact@digitalspirit.org)                                    
                                                                                                            |
                      00004 ; | Ce programme est libre, vous pouvez le redistribuer et/ou le modifier selon les termes de la Licence
                             Publique Générale GNU  |
                      00005 ; | publiée par la Free Software Foundation (version 2 ou bien toute autre version ultérieure choisie pa
                            r vous).                                |
                      00006 ; | Ce programme est distribué car potentiellement utile, mais SANS AUCUNE GARANTIE, ni explicite ni imp
                            licite,                                 |
                      00007 ; | y compris les garanties de commercialisation ou d'adaptation dans un but spécifique.                
                                                                                            |
                      00008 ; | Reportez-vous à la Licence Publique Générale GNU pour plus de détails.                              
                                                                                                            |
                      00009 ; | Vous devez avoir reçu une copie de la Licence Publique Générale GNU en même temps que ce programme ;
                                                                            |
                      00010 ; | si ce n'est pas le cas,                                                                             
                                                                                                                            
                      00011 ; | écrivez à la Free Software Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307, État
                            s-Unis.                                 |
                      00012 ; +-----------------------------------------------------------------------------------------------------
                            ------------------------+
                      00013 ; 2004-11-19 : Lorsque la consigne est 0, le port reste à 1
                      00014 ; 2005-12-03 : Version finale débugguée en test sur Bleuette
                      00015 
                      00016         title           "Gestion de 24 servos !"
                      00017         processor       18F452
                      00018 
                      00019         #include                "p18F452.inc"
                      00001         LIST
                      00002 
                      00003 ;==========================================================================
                      00004 ;  MPASM PIC18F452 processor include
                      00005 ; 
                      00006 ;  (c) Copyright 1999-2012 Microchip Technology, All rights reserved
                      00007 ;==========================================================================
                      00008 
                      01254         LIST
                      00020         #include                "macro.inc"
                      00001 ; +-----------------------------------------------------------------------------------------------------
                            ------------------------+
                      00002 ; | Gestion de 24 servos avec un PIC18F452                                                              
                                                                                                                            
                      00003 ; | Copyright (C) 2012 Charles RINCHEVAL (contact@digitalspirit.org)                                    
                                                                                                            |
                      00004 ; | Ce programme est libre, vous pouvez le redistribuer et/ou le modifier selon les termes de la Licence
                             Publique Générale GNU  |
                      00005 ; | publiée par la Free Software Foundation (version 2 ou bien toute autre version ultérieure choisie pa
                            r vous).                                |
                      00006 ; | Ce programme est distribué car potentiellement utile, mais SANS AUCUNE GARANTIE, ni explicite ni imp
                            licite,                                 |
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE  2
Gestion de 24 servos !

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00007 ; | y compris les garanties de commercialisation ou d'adaptation dans un but spécifique.                
                                                                                            |
                      00008 ; | Reportez-vous à la Licence Publique Générale GNU pour plus de détails.                              
                                                                                                            |
                      00009 ; | Vous devez avoir reçu une copie de la Licence Publique Générale GNU en même temps que ce programme ;
                                                                            |
                      00010 ; | si ce n'est pas le cas,                                                                             
                                                                                                                            
                      00011 ; | écrivez à la Free Software Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307, État
                            s-Unis.                                 |
                      00012 ; +-----------------------------------------------------------------------------------------------------
                            ------------------------+
                      00013 ; Les macros !
                      00014 
                      00015 ;       NOLIST  ; Turn Off Listing File Output !
                      00016 
                      00017 ; Move Literal to F
                      00018 MOVLF   MACRO   literal, dest
                      00019                 movlw   literal
                      00020                 movwf   dest
                      00021                 ENDM
                      00022 
                      00023 ; Pour le DEBUG
                      00024 DON             MACRO
                      00025 ;               bsf             LATC, 7
                      00026 ;               bsf             LATC, 6
                      00027                 bsf             LATC, 5
                      00028                 ENDM
                      00029 
                      00030 DOFF    MACRO
                      00031 ;               bcf             LATC, 7
                      00032 ;               bcf             LATC, 6
                      00033                 bcf             LATC, 5
                      00034                 ENDM
                      00035 
                      00036 
                      00037 ; Move Literal to F Banked
                      00038 MOVLFB  MACRO   literal, dest
                      00039                 movlw   literal
                      00040                 movwf   dest, BANKED
                      00041                 ENDM
                      00042 
                      00043 ; Envoie un caractère sur le port série
                      00044 SEND    MACRO   char
                      00045                 movlw   char
                      00046                 movwf   TXREG
                      00047                 btfss   PIR1, TXIF
                      00048                 goto    $ - 2
                      00049                 ENDM
                      00050 
                      00051 ; Send AD conversion result
                      00052 SEND_AD MACRO   channel
                      00053                 movlw   channel
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE  3
Gestion de 24 servos !

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00054                 call    Adc_Read
                      00055 
                      00056                 movf    Adc_Result_H, W
                      00057                 call    Serial_Send_Delay
                      00058 
                      00059                 movf    Adc_Result_L, W
                      00060                 call    Serial_Send_Delay
                      00061 
                      00062                 ; Checksum calculation
                      00063                 movf    Adc_Result_H, W
                      00064                 addwf   Adc_Result_L, W
                      00065                 call    Serial_Send
                      00066                 ENDM
                      00067 
                      00068 INT_ON  MACRO
                      00069                 bsf     PORTC, 0
                      00070                 ENDM
                      00071 
                      00072 INT_OFF MACRO
                      00073                 bcf             PORTC, 0
                      00074                 ENDM
                      00075 ;       LIST
                      00021 
                      00022 ; Program Configuration Registers
Warning[230]: __CONFIG has been deprecated for PIC18 devices.  Use directive CONFIG.
300000 FEFF           00023         __CONFIG    _CONFIG1H, _HSPLL_OSC_1H    ; _OSCS_OFF_1H & _EC_OSC_1H & 
Warning[230]: __CONFIG has been deprecated for PIC18 devices.  Use directive CONFIG.
                      00024         __CONFIG    _CONFIG2L, _BOR_OFF_2L & _PWRT_OFF_2L
Warning[230]: __CONFIG has been deprecated for PIC18 devices.  Use directive CONFIG.
300002 FEFD           00025         __CONFIG    _CONFIG2H, _WDT_OFF_2H
                      00026 ;       __CONFIG    _CONFIG3H, _CCP2MX_OFF_3H
Warning[230]: __CONFIG has been deprecated for PIC18 devices.  Use directive CONFIG.
300006 FF7A           00027         __CONFIG    _CONFIG4L, _STVR_OFF_4L & _LVP_OFF_4L & _DEBUG_ON_4L
Warning[230]: __CONFIG has been deprecated for PIC18 devices.  Use directive CONFIG.
300008 C0FF           00028         __CONFIG    _CONFIG5L, _CP0_OFF_5L & _CP1_OFF_5L & _CP2_OFF_5L & _CP3_OFF_5L 
                      00029 ;       __CONFIG    _CONFIG5H, _CPB_OFF_5H & _CPD_OFF_5H
Warning[230]: __CONFIG has been deprecated for PIC18 devices.  Use directive CONFIG.
30000A E0FF           00030         __CONFIG    _CONFIG6L, _WRT0_OFF_6L & _WRT1_OFF_6L & _WRT2_OFF_6L & _WRT3_OFF_6L 
                      00031 ;       __CONFIG    _CONFIG6H, _WRTC_OFF_6H & _WRTB_OFF_6H & _WRTD_OFF_6H
Warning[230]: __CONFIG has been deprecated for PIC18 devices.  Use directive CONFIG.
30000C 40FF           00032         __CONFIG    _CONFIG7L, _EBTR0_OFF_7L & _EBTR1_OFF_7L & _EBTR2_OFF_7L & _EBTR3_OFF_7L
                      00033 ;       __CONFIG    _CONFIG7H, _EBTRB_OFF_7H
                      00034 
                      00035 
                      00036 ; +--------------------------+
                      00037 ; | Définition de constantes |
                      00038 ; +--------------------------+
                      00039 
                      00040 #DEFINE         NBR_SERVO       .24
                      00041 
                      00042 #DEFINE         PHASE_1         0x00
                      00043 #DEFINE         PHASE_2         0x01
                      00044 #DEFINE         PHASE_3         0x02
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE  4
Gestion de 24 servos !

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00045 #DEFINE         PHASE_4         0x03
                      00046 
                      00047 #DEFINE         HEADER          0xFF    ; 0xAA (0b10101010)
                      00048 
                      00049 #DEFINE         COMMAND_INIT    'I'
                      00050 #DEFINE         COMMAND_PAUSE   'P'
                      00051 #DEFINE         COMMAND_RESUME  'R'
                      00052 #DEFINE         COMMAND_CLEAR   'C'
                      00053 #DEFINE         COMMAND_SET     'S'
                      00054 
                      00055 #DEFINE         COMMAND_CURRENT 'A' ; Get last current value
                      00056 #DEFINE         COMMAND_STATUS  'T' ; Get status
                      00057 #DEFINE         COMMAND_SET_MAX 'M' ; Set max current limit
                      00058 
                      00059 #DEFINE         COMMAND_READAN0 '0'
                      00060 #DEFINE         COMMAND_READAN1 '1'
                      00061 #DEFINE         COMMAND_READAN2 '2'
                      00062 #DEFINE         COMMAND_READAN3 '3'
                      00063 #DEFINE         COMMAND_READAN4 '4'
                      00064 #DEFINE         COMMAND_READAN5 '5'
                      00065 #DEFINE         COMMAND_READAN6 '6'
                      00066 #DEFINE         COMMAND_READAN7 '7'
                      00067 
                      00068 #DEFINE         ADC_AN0 b'00000000'
                      00069 #DEFINE         ADC_AN1 b'00001000'
                      00070 #DEFINE         ADC_AN2 b'00010000'
                      00071 #DEFINE         ADC_AN3 b'00011000'
                      00072 #DEFINE         ADC_AN4 b'00100000'
                      00073 #DEFINE         ADC_AN5 b'00101000'
                      00074 #DEFINE         ADC_AN6 b'00110000'
                      00075 #DEFINE         ADC_AN7 b'00111000'
                      00076 
                      00077 ; Status bits
                      00078 #DEFINE         INT_STATUS_MAX_CURRENT_REACHED 0
                      00079 
                      00080 #DEFINE         CURRENT_CHANNEL ADC_AN7
                      00081 
                      00082         CBLOCK  0x00    ; zone access ram de la banque 0
  00000000            00083                 servo_cons0     : 1
  00000001            00084                 servo_cons1     : 1
  00000002            00085                 servo_cons2     : 1
  00000003            00086                 servo_cons3     : 1
  00000004            00087                 servo_cons4     : 1
  00000005            00088                 servo_cons5     : 1
  00000006            00089                 servo_cons6     : 1
  00000007            00090                 servo_cons7     : 1
  00000008            00091                 servo_cons8     : 1
  00000009            00092                 servo_cons9             : 1
  0000000A            00093                 servo_cons10    : 1
  0000000B            00094                 servo_cons11    : 1
  0000000C            00095                 servo_cons12    : 1
  0000000D            00096                 servo_cons13    : 1
  0000000E            00097                 servo_cons14    : 1
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE  5
Gestion de 24 servos !

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  0000000F            00098                 servo_cons15    : 1
  00000010            00099                 servo_cons16    : 1
  00000011            00100                 servo_cons17    : 1
  00000012            00101                 servo_cons18    : 1
  00000013            00102                 servo_cons19    : 1
  00000014            00103                 servo_cons20    : 1
  00000015            00104                 servo_cons21    : 1
  00000016            00105                 servo_cons22    : 1
  00000017            00106                 servo_cons23    : 1
                      00107 
  00000018            00108                 servo_sorted    : 24
                      00109 
  0000003C            00110                 cmpt_pass               : 1             ; Le compteur de passage
  0000003D            00111                 current_cons    : 1             ; La consigne courante
  0000003E            00112                 current_servo   : 1     ; Offset du servo courant
  0000003F            00113                 current_qnt             : 1             ; Quantité de servo courante
                      00114 
  00000040            00115                 total_qnt               : 1             ; Quantité totale de servos qui y sont passés
  00000041            00116                 cons_prec               : 1             ; Valeur de la consigne précédente
                      00117 
  00000042            00118                 buf_PORTA               : 1             ; Les buffers des ports
  00000043            00119                 buf_PORTB               : 1
  00000044            00120                 buf_PORTC               : 1
  00000045            00121                 buf_PORTD               : 1
  00000046            00122                 buf_PORTE               : 1
                      00123 
  00000047            00124                 Adc_Result_H    : 1
  00000048            00125                 Adc_Result_L    : 1
                      00126 
  00000049            00127                 Current_Last_H  : 1
  0000004A            00128                 Current_Last_L  : 1
                      00129 
  0000004B            00130                 Current_Max_H   : 1
  0000004C            00131                 Current_Max_L   : 1
                      00132 
  0000004D            00133                 Int_Status              : 1
                      00134 
  0000004E            00135                 Mac
                      00136 
  0000004F            00137                 phase                   : 1             ; La phase courante
  00000050            00138                 phase_cmpt              : 1             ; Phase de comptage
                      00139 
                      00140                 ; In case of multiple byte command
                      00141                 ;Current_Cmd    : 1     ; Current command received from Serial
                      00142                 ;Count_Arg              : 1
                      00143                 ;Arg0                   : 1
                      00144                 ;Arg1                   : 1
                      00145 
                      00146                 ; Variables spécifiques pour le tri
  00000051            00147                 var_min                 : 1
  00000052            00148                 var_max                 : 1
                      00149 
  00000053            00150                 mask                    : 1
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE  6
Gestion de 24 servos !

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  00000054            00151                 mask_tmp                : 1
                      00152 
  00000055            00153                 buf_tab0                : 1
  00000056            00154                 buf_tab1                : 1
  00000057            00155                 buf_tab2                : 1
                      00156 
  00000058            00157                 cmpt_bcl                : 1
                      00158 
  00000059            00159                 tmp_FSR0L               : 1
                      00160 ;               tmp_FSR0H               : 1
                      00161 
  0000005A            00162                 tmp_FSR1L               : 1
  0000005B            00163                 tmp_FSR1H               : 1
                      00164 
  0000005C            00165                 tmp_FSR2L               : 1
                      00166 ;               tmp_FSR2H               : 1
                      00167 
  0000005D            00168                 cmpt                    : 1
  0000005E            00169                 bcl                             : 1
                      00170 
                      00171                 ; Masque de bit
                      00172                 ; Fini les mask de bit
                      00173         ;mask_recept0   : 1             ; Octets contenant les masques de bits
                      00174                 ;mask_recept1   : 1
                      00175                 ;mask_recept2   : 1
                      00176 
                      00177                 ;pos_recept             : 1             ; La position voulue
                      00178                 ;pos_recept1            : 1
                      00179                 ;pos_recept2            : 1
                      00180 
  0000005F            00181                 received_counter : 1
  00000060            00182         pos_0   : 1
  00000061            00183         pos_1   : 1
  00000062            00184         pos_2   : 1
  00000063            00185         pos_3   : 1
  00000064            00186         pos_4   : 1
                      00187 
  00000065            00188         pos_5   : 1
  00000066            00189         pos_6   : 1
  00000067            00190         pos_7   : 1
  00000068            00191         pos_8   : 1
  00000069            00192         pos_9   : 1
                      00193 
  0000006A            00194         pos_10   : 1
  0000006B            00195         pos_11   : 1
  0000006C            00196         pos_12   : 1
  0000006D            00197         pos_13   : 1
                      00198 
  0000006E            00199                 reception_control : 1
  0000006F            00200                 pause_mode : 1
                      00201 
                      00202 ;               cmpt_word               : 1             ; Compteur d'octets
                      00203 ;               cmpt_maj                : 1
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE  7
Gestion de 24 servos !

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00204 
  00000070            00205                 wreg_backup : 1
                      00206 
  00000071            00207                 csaving_IN_FSR2L        : 1             ; Context saving
  00000072            00208                 csaving_IN_FSR2H        : 1
                      00209 
  00000073            00210                 csaving_OUT_FSR2L       : 1             ; Context saving
  00000074            00211                 csaving_OUT_FSR2H       : 1
                      00212         ENDC
                      00213 
                      00214         CBLOCK 0x100    ; Zone Bank 1
  00000100            00215                 servo_nbr00     : 1
  00000101            00216                 servo_nbr01     : 1
  00000102            00217                 servo_nbr02     : 1
  00000103            00218                 servo_nbr03     : 1
  00000104            00219                 servo_nbr04     : 1
  00000105            00220                 servo_nbr05     : 1
  00000106            00221                 servo_nbr06     : 1
  00000107            00222                 servo_nbr07     : 1
  00000108            00223                 servo_nbr08     : 1
  00000109            00224                 servo_nbr09     : 1
  0000010A            00225                 servo_nbr10     : 1
  0000010B            00226                 servo_nbr11     : 1
  0000010C            00227                 servo_nbr12     : 1
  0000010D            00228                 servo_nbr13     : 1
  0000010E            00229                 servo_nbr14     : 1
  0000010F            00230                 servo_nbr15     : 1
  00000110            00231                 servo_nbr16     : 1
  00000111            00232                 servo_nbr17     : 1
  00000112            00233                 servo_nbr18     : 1
  00000113            00234                 servo_nbr19     : 1
  00000114            00235                 servo_nbr20     : 1
  00000115            00236                 servo_nbr21     : 1
  00000116            00237                 servo_nbr22     : 1
  00000117            00238                 servo_nbr23     : 1
                      00239 
  00000118            00240                 servo_val00 : 1 ; 24 * 3 zones contenants les états des ports à chaque itération
  00000119            00241                 servo_val01 : 1
  0000011A            00242                 servo_val02 : 1
  0000011B            00243                 servo_val03 : 1
  0000011C            00244                 servo_val04 : 1
  0000011D            00245                 servo_val05 : 1
  0000011E            00246                 servo_val06 : 1
  0000011F            00247                 servo_val07 : 1
  00000120            00248                 servo_val08 : 1
  00000121            00249                 servo_val09 : 1
  00000122            00250                 servo_val10 : 1
  00000123            00251                 servo_val11 : 1
  00000124            00252                 servo_val12 : 1
  00000125            00253                 servo_val13 : 1
  00000126            00254                 servo_val14 : 1
  00000127            00255                 servo_val15 : 1
  00000128            00256                 servo_val16 : 1
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE  8
Gestion de 24 servos !

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  00000129            00257                 servo_val17 : 1
  0000012A            00258                 servo_val18 : 1
  0000012B            00259                 servo_val19 : 1
  0000012C            00260                 servo_val20 : 1
  0000012D            00261                 servo_val21 : 1
  0000012E            00262                 servo_val22 : 1
  0000012F            00263                 servo_val23 : 1
  00000130            00264                 servo_val24 : 1
  00000131            00265                 servo_val25 : 1
  00000132            00266                 servo_val26 : 1
  00000133            00267                 servo_val27 : 1
  00000134            00268                 servo_val28 : 1
  00000135            00269                 servo_val29 : 1
  00000136            00270                 servo_val30 : 1
  00000137            00271                 servo_val31 : 1
  00000138            00272                 servo_val32 : 1
  00000139            00273                 servo_val33 : 1
  0000013A            00274                 servo_val34 : 1
  0000013B            00275                 servo_val35 : 1
  0000013C            00276                 servo_val36 : 1
  0000013D            00277                 servo_val37 : 1
  0000013E            00278                 servo_val38 : 1
  0000013F            00279                 servo_val39 : 1
  00000140            00280                 servo_val40 : 1
  00000141            00281                 servo_val41 : 1
  00000142            00282                 servo_val42 : 1
  00000143            00283                 servo_val43 : 1
  00000144            00284                 servo_val44 : 1
  00000145            00285                 servo_val45 : 1
  00000146            00286                 servo_val46 : 1
  00000147            00287                 servo_val47 : 1
  00000148            00288                 servo_val48 : 1
  00000149            00289                 servo_val49 : 1
  0000014A            00290                 servo_val50 : 1
  0000014B            00291                 servo_val51 : 1
  0000014C            00292                 servo_val52 : 1
  0000014D            00293                 servo_val53 : 1
  0000014E            00294                 servo_val54 : 1
  0000014F            00295                 servo_val55 : 1
  00000150            00296                 servo_val56 : 1
  00000151            00297                 servo_val57 : 1
  00000152            00298                 servo_val58 : 1
  00000153            00299                 servo_val59 : 1
  00000154            00300                 servo_val60 : 1
  00000155            00301                 servo_val61 : 1
  00000156            00302                 servo_val62 : 1
  00000157            00303                 servo_val63 : 1
  00000158            00304                 servo_val64 : 1
  00000159            00305                 servo_val65 : 1
  0000015A            00306                 servo_val66 : 1
  0000015B            00307                 servo_val67 : 1
  0000015C            00308                 servo_val68 : 1
  0000015D            00309                 servo_val69 : 1
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE  9
Gestion de 24 servos !

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  0000015E            00310                 servo_val70 : 1
  0000015F            00311                 servo_val71 : 1
                      00312         ENDC
                      00313 
                      00314         ; Reset Vector
000000                00315         org             0
000000 0000           00316         nop
000002 D20D           00317         bra             _init
                      00318 
                      00319 
                      00320         ; High Priority Vector
000008                00321         org             0x08
000008 0000           00322         nop
00000A D008           00323         bra             inth
                      00324 
                      00325         ; Low Priority Vector
000018                00326         org             0x18
000018 0000           00327         nop
00001A D00D           00328         bra             intl
                      00329 
                      00330 
                      00331 
                      00332 ; High Priority Vector
00001C                00333 inth
                      00334         ; Pause ?
00001C 0E00           00335         movlw   0
00001E 626F           00336         cpfseq  pause_mode
000020 EF0C F002      00337         goto    inth_end
                      00338 
                      00339         ; "Switch" des interruptions
000024 B4F2           00340         btfsc   INTCON, TMR0IF
000026 EF94 F001      00341         goto    _inth_Timer
                      00342 
00002A 90CD           00343         bcf             T1CON, TMR1ON
00002C 8ED5           00344         bsf             T0CON, TMR0ON
00002E B09E           00345         btfsc   PIR1, TMR1IF
000030 EF94 F001      00346         goto    _inth_Timer
                      00347 
000034 0011           00348         retfie  FAST
                      00349 
                      00350 
                      00351 ; Low Priority Vector
000036                00352 intl
000036 BA9E           00353         btfsc   PIR1, RCIF
000038 EF1F F000      00354         goto    _intl_usart
00003C 0010           00355         retfie
                      00356 
                      00357 
                      00358 ; Interruption venant de l'USART
00003E                00359 _intl_usart
                      00360         ; Backup WREG
00003E 6E70           00361         movwf   wreg_backup
                      00362 
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 10
Gestion de 24 servos !

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00363 ; 0: Reception de l'entete
000040 0E00           00364         movlw   0
000042 625F           00365         cpfseq  received_counter
000044 EF2A F000      00366         goto    _intl_usart_received_test_cmd
                      00367         ;goto   _int1_usart_received_test_setmax
                      00368 
                      00369         ; Test si le premier est bien egal a 255
000048 0EFF           00370         movlw   HEADER
00004A 62AE           00371         cpfseq  RCREG
00004C EF1B F001      00372         goto    _int1_usart_clear
000050 EF90 F001      00373         goto    _intl_usart_end
                      00374 
                      00375 ; +------------------+
                      00376 ; | Multiple command |
                      00377 ; +------------------+
                      00378 
                      00379 ; Test for pause command
                      00380 ;_int1_usart_received_test_setmax
                      00381 
                      00382         ; First, test if Current_Cmd is set
                      00383 ;       movlw   0
                      00384 ;       tstfsz  Current_Cmd
                      00385 ;       goto    _int1_uart_multiple
                      00386 ;       goto    _intl_usart_received_test_cmd
                      00387 
                      00388         ; Is Set Max command ?
                      00389 ;       movlw   Current_Cmd
                      00390 ;       cpfseq  COMMAND_SET_MAX
                      00391 ;       goto    _intl_usart_received_test_cmd
                      00392 
                      00393         ; Wait for 2 args
                      00394 ;       movlw   1
                      00395 ;       cpfsgt  Arg_Count
                      00396 ;       goto    _intl_usart_received_test_cmd
                      00397 
                      00398         ;goto   _int1_usart_received_send_ack
                      00399 
                      00400 
                      00401 ; 1: Command
000054                00402 _intl_usart_received_test_cmd
000054 0E01           00403         movlw   .1
000056 625F           00404         cpfseq  received_counter
000058 EF1E F001      00405         goto    _intl_usart_received_test_pos0
                      00406 
                      00407 ; Test for set command
00005C                00408 _int1_usart_received_test_set
00005C 0E53           00409         movlw   COMMAND_SET
00005E 62AE           00410         cpfseq  RCREG
000060 EF34 F000      00411         goto    _int1_usart_received_test_init
000064 EF90 F001      00412         goto    _intl_usart_end
                      00413 
                      00414 ; Test for init command
000068                00415 _int1_usart_received_test_init
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 11
Gestion de 24 servos !

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000068 0E49           00416         movlw   COMMAND_INIT
00006A 62AE           00417         cpfseq  RCREG
00006C EF3E F000      00418         goto    _int1_usart_received_test_pause
                      00419         ; Set all value to 0
000070 0E00           00420         movlw   0
000072 ECD3 F003      00421         call    setValue
000076 8AF2           00422         bsf     INTCON, TMR0IE
000078 EF0F F001      00423         goto    _int1_usart_received_send_ack
                      00424 
                      00425 ; Test for pause command
00007C                00426 _int1_usart_received_test_pause
00007C 0E50           00427         movlw   COMMAND_PAUSE
00007E 62AE           00428         cpfseq  RCREG
000080 EF47 F000      00429         goto    _int1_usart_received_test_resume
                      00430 
000084 696F           00431         setf    pause_mode, 1
000086 ECEC F003      00432         call    clearAllOut
00008A EF0F F001      00433         goto    _int1_usart_received_send_ack
                      00434 
                      00435 ; Test for resume command
00008E                00436 _int1_usart_received_test_resume
00008E 0E52           00437         movlw   COMMAND_RESUME
000090 62AE           00438         cpfseq  RCREG
000092 EF4E F000      00439         goto    _int1_usart_received_test_cur
                      00440 
000096 6A6F           00441         clrf    pause_mode
000098 EF0F F001      00442         goto    _int1_usart_received_send_ack
                      00443 
                      00444 ; Test for read current
00009C                00445 _int1_usart_received_test_cur
00009C 0E41           00446         movlw   COMMAND_CURRENT
00009E 62AE           00447         cpfseq  RCREG
0000A0 EF5E F000      00448         goto    _int1_usart_received_test_stat
                      00449 
0000A4 5049           00450         movf    Current_Last_H, W
0000A6 EC9D F003      00451         call    Serial_Send_Delay
                      00452 
0000AA 504A           00453         movf    Current_Last_L, W
0000AC EC9D F003      00454         call    Serial_Send_Delay
                      00455 
                      00456         ; Checksum calculation
0000B0 5049           00457         movf    Current_Last_H, W
0000B2 244A           00458         addwf   Current_Last_L, W
0000B4 EC98 F003      00459         call    Serial_Send
                      00460 
0000B8 EF1B F001      00461         goto    _int1_usart_clear
                      00462 
                      00463 ; Test for get status
0000BC                00464 _int1_usart_received_test_stat
0000BC 0E54           00465         movlw   COMMAND_STATUS
0000BE 62AE           00466         cpfseq  RCREG
0000C0 EF6B F000      00467         goto    _int1_usart_received_test_ana0
                      00468 
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 12
Gestion de 24 servos !

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0000C4 504D           00469         movf    Int_Status, W
0000C6 EC98 F003      00470         call    Serial_Send
                      00471 
0000CA 6A49           00472         clrf    Current_Last_H
0000CC 6A4A           00473         clrf    Current_Last_L
0000CE 904D           00474         bcf     Int_Status, INT_STATUS_MAX_CURRENT_REACHED
                      00475         INT_OFF
0000D0 9082               M                 bcf             PORTC, 0
                      00476 
0000D2 EF1B F001      00477         goto    _int1_usart_clear
                      00478 
                      00479 ; Test for read analog 0 command
0000D6                00480 _int1_usart_received_test_ana0
0000D6 0E30           00481         movlw   COMMAND_READAN0
0000D8 62AE           00482         cpfseq  RCREG
0000DA EF7E F000      00483         goto    _int1_usart_received_test_ana1
                      00484 
                      00485         SEND_AD ADC_AN0
0000DE 0E00               M                 movlw   b'00000000'
0000E0 EC86 F003          M                 call    Adc_Read
                          M 
0000E4 5047               M                 movf    Adc_Result_H, W
0000E6 EC9D F003          M                 call    Serial_Send_Delay
                          M 
0000EA 5048               M                 movf    Adc_Result_L, W
0000EC EC9D F003          M                 call    Serial_Send_Delay
                          M 
                          M                 ; Checksum calculation
0000F0 5047               M                 movf    Adc_Result_H, W
0000F2 2448               M                 addwf   Adc_Result_L, W
0000F4 EC98 F003          M                 call    Serial_Send
0000F8 EF1B F001      00486         goto    _int1_usart_clear
                      00487 
                      00488 ; Test for read analog 1 command
0000FC                00489 _int1_usart_received_test_ana1
0000FC 0E31           00490         movlw   COMMAND_READAN1
0000FE 62AE           00491         cpfseq  RCREG
000100 EF91 F000      00492         goto    _int1_usart_received_test_ana2
                      00493 
                      00494         SEND_AD ADC_AN1
000104 0E08               M                 movlw   b'00001000'
000106 EC86 F003          M                 call    Adc_Read
                          M 
00010A 5047               M                 movf    Adc_Result_H, W
00010C EC9D F003          M                 call    Serial_Send_Delay
                          M 
000110 5048               M                 movf    Adc_Result_L, W
000112 EC9D F003          M                 call    Serial_Send_Delay
                          M 
                          M                 ; Checksum calculation
000116 5047               M                 movf    Adc_Result_H, W
000118 2448               M                 addwf   Adc_Result_L, W
00011A EC98 F003          M                 call    Serial_Send
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 13
Gestion de 24 servos !

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00011E EF1B F001      00495         goto    _int1_usart_clear
                      00496 
                      00497 ; Test for read analog 2 command
000122                00498 _int1_usart_received_test_ana2
000122 0E32           00499         movlw   COMMAND_READAN2
000124 62AE           00500         cpfseq  RCREG
000126 EFA4 F000      00501         goto    _int1_usart_received_test_ana3
                      00502 
                      00503         SEND_AD ADC_AN2
00012A 0E10               M                 movlw   b'00010000'
00012C EC86 F003          M                 call    Adc_Read
                          M 
000130 5047               M                 movf    Adc_Result_H, W
000132 EC9D F003          M                 call    Serial_Send_Delay
                          M 
000136 5048               M                 movf    Adc_Result_L, W
000138 EC9D F003          M                 call    Serial_Send_Delay
                          M 
                          M                 ; Checksum calculation
00013C 5047               M                 movf    Adc_Result_H, W
00013E 2448               M                 addwf   Adc_Result_L, W
000140 EC98 F003          M                 call    Serial_Send
000144 EF1B F001      00504         goto    _int1_usart_clear
                      00505 
                      00506 ; Test for read analog 3 command
000148                00507 _int1_usart_received_test_ana3
000148 0E33           00508         movlw   COMMAND_READAN3
00014A 62AE           00509         cpfseq  RCREG
00014C EFB7 F000      00510         goto    _int1_usart_received_test_ana4
                      00511 
                      00512         SEND_AD ADC_AN3
000150 0E18               M                 movlw   b'00011000'
000152 EC86 F003          M                 call    Adc_Read
                          M 
000156 5047               M                 movf    Adc_Result_H, W
000158 EC9D F003          M                 call    Serial_Send_Delay
                          M 
00015C 5048               M                 movf    Adc_Result_L, W
00015E EC9D F003          M                 call    Serial_Send_Delay
                          M 
                          M                 ; Checksum calculation
000162 5047               M                 movf    Adc_Result_H, W
000164 2448               M                 addwf   Adc_Result_L, W
000166 EC98 F003          M                 call    Serial_Send
00016A EF1B F001      00513         goto    _int1_usart_clear
                      00514 
                      00515 ; Test for read analog 4 command
00016E                00516 _int1_usart_received_test_ana4
00016E 0E34           00517         movlw   COMMAND_READAN4
000170 62AE           00518         cpfseq  RCREG
000172 EFCA F000      00519         goto    _int1_usart_received_test_ana5
                      00520 
                      00521         SEND_AD ADC_AN4
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 14
Gestion de 24 servos !

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000176 0E20               M                 movlw   b'00100000'
000178 EC86 F003          M                 call    Adc_Read
                          M 
00017C 5047               M                 movf    Adc_Result_H, W
00017E EC9D F003          M                 call    Serial_Send_Delay
                          M 
000182 5048               M                 movf    Adc_Result_L, W
000184 EC9D F003          M                 call    Serial_Send_Delay
                          M 
                          M                 ; Checksum calculation
000188 5047               M                 movf    Adc_Result_H, W
00018A 2448               M                 addwf   Adc_Result_L, W
00018C EC98 F003          M                 call    Serial_Send
000190 EF1B F001      00522         goto    _int1_usart_clear
                      00523 
                      00524 ; Test for read analog 5 command
000194                00525 _int1_usart_received_test_ana5
000194 0E35           00526         movlw   COMMAND_READAN5
000196 62AE           00527         cpfseq  RCREG
000198 EFDD F000      00528         goto    _int1_usart_received_test_ana6
                      00529 
                      00530         SEND_AD ADC_AN5
00019C 0E28               M                 movlw   b'00101000'
00019E EC86 F003          M                 call    Adc_Read
                          M 
0001A2 5047               M                 movf    Adc_Result_H, W
0001A4 EC9D F003          M                 call    Serial_Send_Delay
                          M 
0001A8 5048               M                 movf    Adc_Result_L, W
0001AA EC9D F003          M                 call    Serial_Send_Delay
                          M 
                          M                 ; Checksum calculation
0001AE 5047               M                 movf    Adc_Result_H, W
0001B0 2448               M                 addwf   Adc_Result_L, W
0001B2 EC98 F003          M                 call    Serial_Send
0001B6 EF1B F001      00531         goto    _int1_usart_clear
                      00532 
                      00533 ; Test for read analog 6 command
0001BA                00534 _int1_usart_received_test_ana6
0001BA 0E36           00535         movlw   COMMAND_READAN6
0001BC 62AE           00536         cpfseq  RCREG
0001BE EFF0 F000      00537         goto    _int1_usart_received_test_ana7
                      00538 
                      00539         SEND_AD ADC_AN6
0001C2 0E30               M                 movlw   b'00110000'
0001C4 EC86 F003          M                 call    Adc_Read
                          M 
0001C8 5047               M                 movf    Adc_Result_H, W
0001CA EC9D F003          M                 call    Serial_Send_Delay
                          M 
0001CE 5048               M                 movf    Adc_Result_L, W
0001D0 EC9D F003          M                 call    Serial_Send_Delay
                          M 
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 15
Gestion de 24 servos !

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M                 ; Checksum calculation
0001D4 5047               M                 movf    Adc_Result_H, W
0001D6 2448               M                 addwf   Adc_Result_L, W
0001D8 EC98 F003          M                 call    Serial_Send
0001DC EF1B F001      00540         goto    _int1_usart_clear
                      00541 
                      00542 ; Test for read analog 7 command
0001E0                00543 _int1_usart_received_test_ana7
0001E0 0E37           00544         movlw   COMMAND_READAN7
0001E2 62AE           00545         cpfseq  RCREG
0001E4 EF05 F001      00546         goto    _int1_usart_received_test_clear
                      00547 
0001E8 828B           00548         bsf     LATC, 1
                      00549         SEND_AD ADC_AN7
0001EA 0E38               M                 movlw   b'00111000'
0001EC EC86 F003          M                 call    Adc_Read
                          M 
0001F0 5047               M                 movf    Adc_Result_H, W
0001F2 EC9D F003          M                 call    Serial_Send_Delay
                          M 
0001F6 5048               M                 movf    Adc_Result_L, W
0001F8 EC9D F003          M                 call    Serial_Send_Delay
                          M 
                          M                 ; Checksum calculation
0001FC 5047               M                 movf    Adc_Result_H, W
0001FE 2448               M                 addwf   Adc_Result_L, W
000200 EC98 F003          M                 call    Serial_Send
000204 928B           00550         bcf     LATC, 1
000206 EF1B F001      00551         goto    _int1_usart_clear
                      00552 
                      00553 ; Test for clear command
00020A                00554 _int1_usart_received_test_clear
00020A 0E43           00555         movlw   COMMAND_CLEAR
00020C 62AE           00556         cpfseq  RCREG
00020E EF16 F001      00557         goto    _intl_usart_unknow_command
                      00558 
000212 6A6F           00559         clrf    pause_mode
                      00560         ; Set all value to 0
000214 0E00           00561         movlw   0
000216 ECD3 F003      00562         call    setValue
00021A EF0F F001      00563         goto    _int1_usart_received_send_ack
                      00564 
                      00565         ; Si command n'est pas egal a 1, on clear et on quitte
                      00566 ;       movlw .1
                      00567 ;       cpfseq RCREG
                      00568 ;       goto _int1_usart_clear
                      00569 ;       goto _intl_usart_end
                      00570 
00021E                00571 _int1_usart_received_send_ack
                      00572         SEND 'O'
00021E 0E4F               M                 movlw   'O'
000220 6EAD               M                 movwf   TXREG
000222 A89E               M                 btfss   PIR1, TXIF
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 16
Gestion de 24 servos !

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000224 EF11 F001          M                 goto    $ - 2
000228 EF1B F001      00573         goto _int1_usart_clear
                      00574 
00022C                00575 _intl_usart_unknow_command
                      00576         SEND 'N'
00022C 0E4E               M                 movlw   'N'
00022E 6EAD               M                 movwf   TXREG
000230 A89E               M                 btfss   PIR1, TXIF
000232 EF18 F001          M                 goto    $ - 2
000236                00577 _int1_usart_clear
000236 6A5F           00578         clrf received_counter
000238 EF91 F001      00579         goto _intl_usart_exit
                      00580 
                      00581 ; 2: Position 0
00023C                00582 _intl_usart_received_test_pos0
00023C 0E02           00583         movlw .2
00023E 625F           00584         cpfseq received_counter
000240 EF26 F001      00585         goto _intl_usart_received_test_pos1
000244 50AE           00586         movf RCREG, W
000246 6E60           00587         movwf pos_0
000248 EF90 F001      00588         goto _intl_usart_end
                      00589 
                      00590 ; 3: Position 1
00024C                00591 _intl_usart_received_test_pos1
00024C 0E03           00592         movlw .3
00024E 625F           00593         cpfseq received_counter
000250 EF2E F001      00594         goto _intl_usart_received_test_pos2
000254 50AE           00595         movf RCREG, W
000256 6E61           00596         movwf pos_1
000258 EF90 F001      00597         goto _intl_usart_end
                      00598 
                      00599 ; 4: Position 2
00025C                00600 _intl_usart_received_test_pos2
00025C 0E04           00601         movlw .4
00025E 625F           00602         cpfseq received_counter
000260 EF36 F001      00603         goto _intl_usart_received_test_pos3
000264 50AE           00604         movf RCREG, W
000266 6E62           00605         movwf pos_2
000268 EF90 F001      00606         goto _intl_usart_end
                      00607 
                      00608 ; 5: Position 3
00026C                00609 _intl_usart_received_test_pos3
00026C 0E05           00610         movlw .5
00026E 625F           00611         cpfseq received_counter
000270 EF3E F001      00612         goto _intl_usart_received_test_pos4
000274 50AE           00613         movf RCREG, W
000276 6E63           00614         movwf pos_3
000278 EF90 F001      00615         goto _intl_usart_end
                      00616 
                      00617 ; 6: Position 4
00027C                00618 _intl_usart_received_test_pos4
00027C 0E06           00619         movlw 6
00027E 625F           00620         cpfseq received_counter
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 17
Gestion de 24 servos !

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000280 EF46 F001      00621         goto _intl_usart_received_test_pos5
000284 50AE           00622         movf RCREG, W
000286 6E64           00623         movwf pos_4
000288 EF90 F001      00624         goto _intl_usart_end
                      00625 
                      00626 ; 7: Position 5
00028C                00627 _intl_usart_received_test_pos5
00028C 0E07           00628         movlw .7
00028E 625F           00629         cpfseq received_counter
000290 EF4E F001      00630         goto _intl_usart_received_test_pos6
000294 50AE           00631         movf RCREG, W
000296 6E65           00632         movwf pos_5
000298 EF90 F001      00633         goto _intl_usart_end
                      00634 
                      00635 ; 8: Position 6
00029C                00636 _intl_usart_received_test_pos6
00029C 0E08           00637         movlw .8
00029E 625F           00638         cpfseq received_counter
0002A0 EF56 F001      00639         goto _intl_usart_received_test_pos7
0002A4 50AE           00640         movf RCREG, W
0002A6 6E66           00641         movwf pos_6
0002A8 EF90 F001      00642         goto _intl_usart_end
                      00643 
                      00644 ; 9: Position 7
0002AC                00645 _intl_usart_received_test_pos7
0002AC 0E09           00646         movlw .9
0002AE 625F           00647         cpfseq received_counter
0002B0 EF5E F001      00648         goto _intl_usart_received_test_pos8
0002B4 50AE           00649         movf RCREG, W
0002B6 6E67           00650         movwf pos_7
0002B8 EF90 F001      00651         goto _intl_usart_end
                      00652 
                      00653 ; 10: Position 8
0002BC                00654 _intl_usart_received_test_pos8
0002BC 0E0A           00655         movlw .10
0002BE 625F           00656         cpfseq received_counter
0002C0 EF66 F001      00657         goto _intl_usart_received_test_pos9
0002C4 50AE           00658         movf RCREG, W
0002C6 6E68           00659         movwf pos_8
0002C8 EF90 F001      00660         goto _intl_usart_end
                      00661 
                      00662 ; 11: Position 9
0002CC                00663 _intl_usart_received_test_pos9
0002CC 0E0B           00664         movlw .11
0002CE 625F           00665         cpfseq received_counter
0002D0 EF6E F001      00666         goto _intl_usart_received_test_pos10
0002D4 50AE           00667         movf RCREG, W
0002D6 6E69           00668         movwf pos_9
0002D8 EF90 F001      00669         goto _intl_usart_end
                      00670 
                      00671 ; 12: Position 10
0002DC                00672 _intl_usart_received_test_pos10
0002DC 0E0C           00673         movlw .12
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 18
Gestion de 24 servos !

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0002DE 625F           00674         cpfseq received_counter
0002E0 EF76 F001      00675         goto _intl_usart_received_test_pos11
0002E4 50AE           00676         movf RCREG, W
0002E6 6E6A           00677         movwf pos_10
0002E8 EF90 F001      00678         goto _intl_usart_end
                      00679 
                      00680 ; 13: Position 11
0002EC                00681 _intl_usart_received_test_pos11
0002EC 0E0D           00682         movlw .13
0002EE 625F           00683         cpfseq received_counter
0002F0 EF7E F001      00684         goto _intl_usart_received_test_pos12
0002F4 50AE           00685         movf RCREG, W
0002F6 6E6B           00686         movwf pos_11
0002F8 EF90 F001      00687         goto _intl_usart_end
                      00688 
                      00689 ; 14: Position 12
0002FC                00690 _intl_usart_received_test_pos12
0002FC 0E0E           00691         movlw .14
0002FE 625F           00692         cpfseq received_counter
000300 EF86 F001      00693         goto _intl_usart_received_test_pos13
000304 50AE           00694         movf RCREG, W
000306 6E6C           00695         movwf pos_12
000308 EF90 F001      00696         goto _intl_usart_end
                      00697 
                      00698 ; 15: Position 13
00030C                00699 _intl_usart_received_test_pos13
00030C 0E0F           00700         movlw .15
00030E 625F           00701         cpfseq received_counter
000310 EF8E F001      00702         goto _intl_usart_received_test_ctrl
000314 50AE           00703         movf RCREG, W
000316 6E6D           00704         movwf pos_13
000318 EF90 F001      00705         goto _intl_usart_end
                      00706 
                      00707 ; 17: Control byte
00031C                00708 _intl_usart_received_test_ctrl
00031C 50AE           00709         movf RCREG, W
00031E 6E6E           00710         movwf reception_control
                      00711 
000320                00712 _intl_usart_end
000320 2A5F           00713         incf received_counter
                      00714 
000322                00715 _intl_usart_exit
                      00716         ; Restore WREG
000322 0E70           00717         movlw   wreg_backup
000324 9A9E           00718         bcf             PIR1, RCIF
000326 0010           00719         retfie
                      00720 
                      00721 
                      00722 
                      00723 
                      00724 ; Interruption du Timer
000328                00725 _inth_Timer
                      00726 
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 19
Gestion de 24 servos !

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00727         ; Aiguillage vers la bonne phase
000328 B250           00728         btfsc   phase_cmpt, .1
00032A EFF7 F001      00729         goto    phase3
                      00730 
                      00731 
                      00732 ; ###########
                      00733 ; # PHASE 1 #
                      00734 ; ###########
                      00735 
00032E EC76 F004      00736         call    sort
                      00737 
000332 0E48           00738         movlw   0x48                            ; Ajout hugo, le 10/02/2005
000334 6ECF           00739         movwf   TMR1H                           ; Pour être sûr que la période soit de 20ms
000336 0EA0           00740         movlw   0xA0
000338 6ECE           00741         movwf   TMR1L
00033A 80CD           00742         bsf             T1CON, TMR1ON           ; Pour revenir dans 20ms
                      00743 
00033C ECF0 F003      00744         call    setAllPort                      ; Allumage des ports !
                      00745 
                      00746 
                      00747         ; Tempo de 400us, oui, c'est dommage ...
                      00748         ; ... on pourrait se servir de ce temps pour autre chose ...
                      00749         ; ... il faut donc refaire la routine de tri !
000340 0EFF           00750         movlw   0xFF
000342 6E58           00751         movwf   cmpt_bcl
000344                00752 bcl_toto
000344 D000           00753         bra             $ + 2
000346 D000           00754         bra             $ + 2
000348 D000           00755         bra             $ + 2
00034A D000           00756         bra             $ + 2
00034C D000           00757         bra             $ + 2
00034E D000           00758         bra             $ + 2
000350 2E58           00759         decfsz  cmpt_bcl
000352 D7F8           00760         bra             bcl_toto
                      00761 
000354 D0             00762         fill(bra        $ + 2), 64      ; 64 -> Passage en repos à l'état bas
                      00763 
                      00764 ; ###########
                      00765 ; # PHASE 2 #
                      00766 ; ###########
                      00767         
0003B8 EE00 F018      00768         lfsr    FSR0, servo_sorted      ; Pointeur de consignes
0003BC EE11 F018      00769         lfsr    FSR1, servo_val00       ; Pointeur des ports actifs
0003C0 EE21 F000      00770         lfsr    FSR2, servo_nbr00       ; Pointeur de la quantité courante
                      00771 
0003C4 6A40           00772         clrf    total_qnt
0003C6 6A41           00773         clrf    cons_prec
                      00774 
0003C8                00775 phase2
0003C8 50EF           00776         movf    INDF0, W
0003CA 6E3D           00777         movwf   current_cons            ; La consigne courante
                      00778 
0003CC 5041           00779         movf    cons_prec, W
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 20
Gestion de 24 servos !

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0003CE 5E3D           00780         subwf   current_cons, F         ; On ne compte que le décalage par rapport au précédent
                      00781 
0003D0 E019           00782         bz              phase4                          ; Consigne courante à 0 ?
                      00783 
0003D2 50EF           00784         movf    INDF0, W
0003D4 6E41           00785         movwf   cons_prec
                      00786 
0003D6 0E01           00787         movlw   .1
0003D8 6E3C           00788         movwf   cmpt_pass
                      00789 
                      00790 
0003DA 6850           00791         setf    phase_cmpt                      ; Phase de comptage
                      00792 
                      00793 
0003DC 0000           00794         nop                                                     ; Très important pour la précision !
0003DE 0000           00795         nop                                                     ; Ne pas toucher !!
                      00796 
0003E0 0000           00797         nop             ; Ajout pour passage en mode repos niveau haut
0003E2 0000           00798         nop             ; "
0003E4 0000           00799         nop             ; "
                      00800 
0003E6 0000           00801         nop
0003E8 0000           00802         nop
0003EA 0000           00803         nop
0003EC 0000           00804         nop
                      00805 
                      00806 ; ###########
                      00807 ; # PHASE 3 #
                      00808 ; ###########
0003EE                00809 phase3
0003EE 0EFF           00810         movlw   0xFF
0003F0 6ED7           00811         movwf   TMR0H
                      00812 
0003F2 0EE1           00813         movlw   0xE1
                      00814 
0003F4 6ED6           00815         movwf   TMR0L
                      00816 
0003F6 0000           00817         nop
                      00818 
0003F8 2A3C           00819         incf    cmpt_pass                       ; Incrémente le compteur
                      00820 
0003FA 503D           00821         movf    current_cons, W
0003FC 643C           00822         cpfsgt  cmpt_pass                       ; Si cmpt est supérieur à la consigne courante, on skip
0003FE D00C           00823         bra             inth_end
                      00824 
000400 6A50           00825         clrf    phase_cmpt                      ; Sinon, on a fini de compter
                      00826 
                      00827 
                      00828 ; ###########
                      00829 ; # PHASE 4 #
                      00830 ; ###########
000402 0000           00831         nop
000404                00832 phase4
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 21
Gestion de 24 servos !

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000404 EC2F F004      00833         call    clrPort                         ; Extinction du ou des servos courants
                      00834 
000408 50DE           00835         movf    POSTINC2, W                     ; Addition de la quantité courante ...
00040A 2640           00836         addwf   total_qnt, F            ; ... et de la quantité de servos déjà passés
                      00837 
00040C 2AE9           00838         incf    FSR0L
00040E 0000           00839         nop
                      00840 
000410 0E17           00841         movlw   NBR_SERVO - 1
000412 6440           00842         cpfsgt  total_qnt                       ; Si le total de servo déjà passé est égal au nombre de 
                            servo, on skip !
000414 D7D9           00843         bra             phase2
                      00844 
                      00845 
                      00846 ; ###########
                      00847 ; # PHASE 5 #
                      00848 ; ###########
                      00849 
                      00850 ;       movlw   0x61                            ; Supprimé hugo, le 10/02/2005
                      00851 ;       movwf   TMR1H                           ; Pour être sûr que la période soit de 20ms
                      00852 ;       movlw   0xFF                            ; ... 0xFF pour 20ms pile poil !
                      00853 ;       movwf   TMR1L
                      00854 
000416 9ED5           00855         bcf             T0CON, TMR0ON
                      00856 ;       bsf             T1CON, TMR1ON           ; Supprimé hugo, le 10/02/2005
                      00857 
                      00858 ; On sort de l'interruption
000418                00859 inth_end
000418 909E           00860         bcf             PIR1, TMR1IF
00041A 94F2           00861         bcf             INTCON, TMR0IF
00041C 0011           00862         retfie  FAST
                      00863 
                      00864 
                      00865 
                      00866 
                      00867         #include "init.inc"
                      00001 ; +-----------------------------------------------------------------------------------------------------
                            ------------------------+
                      00002 ; | Gestion de 24 servos avec un PIC18F452                                                              
                                                                                                                            
                      00003 ; | Copyright (C) 2012 Charles RINCHEVAL (contact@digitalspirit.org)                                    
                                                                                                            |
                      00004 ; | Ce programme est libre, vous pouvez le redistribuer et/ou le modifier selon les termes de la Licence
                             Publique Générale GNU  |
                      00005 ; | publiée par la Free Software Foundation (version 2 ou bien toute autre version ultérieure choisie pa
                            r vous).                                |
                      00006 ; | Ce programme est distribué car potentiellement utile, mais SANS AUCUNE GARANTIE, ni explicite ni imp
                            licite,                                 |
                      00007 ; | y compris les garanties de commercialisation ou d'adaptation dans un but spécifique.                
                                                                                            |
                      00008 ; | Reportez-vous à la Licence Publique Générale GNU pour plus de détails.                              
                                                                                                            |
                      00009 ; | Vous devez avoir reçu une copie de la Licence Publique Générale GNU en même temps que ce programme ;
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 22
Gestion de 24 servos !

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                                                                            |
                      00010 ; | si ce n'est pas le cas,                                                                             
                                                                                                                            
                      00011 ; | écrivez à la Free Software Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307, État
                            s-Unis.                                 |
                      00012 ; +-----------------------------------------------------------------------------------------------------
                            ------------------------+
                      00013 ; Initialisation du bouzin !
                      00014 
00041E                00015 _init
                      00016 
                      00017         ; Configuration des ports
                      00018         MOVLF   b'00011111', TRISA
00041E 0E1F               M                 movlw   b'00011111'
000420 6E92               M                 movwf   TRISA
                      00019         MOVLF   b'00000000', TRISB
000422 0E00               M                 movlw   b'00000000'
000424 6E93               M                 movwf   TRISB
                      00020         MOVLF   b'10000000', TRISC
000426 0E80               M                 movlw   b'10000000'
000428 6E94               M                 movwf   TRISC
                      00021         MOVLF   b'00000000', TRISD
00042A 0E00               M                 movlw   b'00000000'
00042C 6E95               M                 movwf   TRISD
                      00022         MOVLF   b'00000111', TRISE
00042E 0E07               M                 movlw   b'00000111'
000430 6E96               M                 movwf   TRISE
                      00023 
                      00024         ; Initialisation des ports
                      00025         MOVLF   b'00000000', PORTA
000432 0E00               M                 movlw   b'00000000'
000434 6E80               M                 movwf   PORTA
                      00026         MOVLF   b'00000000', PORTB
000436 0E00               M                 movlw   b'00000000'
000438 6E81               M                 movwf   PORTB
                      00027         MOVLF   b'00000000', PORTC
00043A 0E00               M                 movlw   b'00000000'
00043C 6E82               M                 movwf   PORTC
                      00028         MOVLF   b'00000000', PORTD
00043E 0E00               M                 movlw   b'00000000'
000440 6E83               M                 movwf   PORTD
                      00029         MOVLF   b'00000000', PORTE
000442 0E00               M                 movlw   b'00000000'
000444 6E84               M                 movwf   PORTE
                      00030 
                      00031         ; RCON REGISTER
                      00032         ; +------+---+---+----+----+----+-----+-----+
                      00033         ; | IPEN |  |  | RI | TO | PD | POR | BOR |
                      00034         ; +------+---+---+----+----+----+-----+-----+
                      00035         ; bit 7
                      00036         ;       IPEN: Interrupt Priority Enable bit
                      00037         ;       1 = Enable priority levels on interrupts
                      00038         ;       0 = Disable prioyarity levels on interrupts (16CXXX Compatibility mode)
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 23
Gestion de 24 servos !

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00039         ; bit 6-5 Unimplemented: Read as '0'
                      00040         ; bit 4 RI: RESET Instruction Flag bit
                      00041         ;       1 = The RESET instruction was not executed
                      00042         ;       0 = The RESET instruction was executed causing a device RESET
                      00043         ;       (must be set in software after a Brown-out Reset occurs)
                      00044         ; bit 3 TO: Watchdog Time-out Flag bit
                      00045         ;       1 = After power-up, CLRWDT instruction, or SLEEP instruction
                      00046         ;       0 = A WDT time-out occurred
                      00047         ; bit 2 PD: Power-down Detection Flag bit
                      00048         ;       1 = After power-up or by the CLRWDT instruction
                      00049         ;       0 = By execution of the SLEEP instruction
                      00050         ; bit 1 POR: Power-on Reset Status bit
                      00051         ;       1 = A Power-on Reset has not occurred
                      00052         ;       0 = A Power-on Reset occurred
                      00053         ;       (must be set in software after a Power-on Reset occurs)
                      00054         ; bit 0 BOR: Brown-out Reset Status bit
                      00055         ;       1 = A Brown-out Reset has not occurred
                      00056         ;       0 = A Brown-out Reset occurred
                      00057         ;       (must be set in software after a Brown-out Reset occurs)
                      00058         MOVLF   b'10000000', RCON
000446 0E80               M                 movlw   b'10000000'
000448 6ED0               M                 movwf   RCON
                      00059 
                      00060         ; INTCON Register
                      00061         ; +----------+-----------+--------+--------+------+--------+--------+------+
                      00062         ; | GIE/GIEH | PEIE/GIEL | TMR0IE | INT0IE | RBIE | TMR0IF | INT0IF | RBIF |
                      00063         ; +----------+-----------+--------+--------+------+--------+--------+------+
                      00064         ; bit 7 GIE/GIEH: Global Interrupt Enable bit
                      00065         ;       When IPEN = 0:
                      00066         ;               1 = Enables all unmasked interrupts
                      00067         ;               0 = Disables all interrupts
                      00068         ;       When IPEN = 1:
                      00069         ;               1 = Enables all high priority interrupts
                      00070         ;               0 = Disables all interrupts
                      00071         ; bit 6 PEIE/GIEL: Peripheral Interrupt Enable bit
                      00072         ;       When IPEN = 0:
                      00073         ;               1 = Enables all unmasked peripheral interrupts
                      00074         ;               0 = Disables all peripheral interrupts
                      00075         ;       When IPEN = 1:
                      00076         ;               1 = Enables all low priority peripheral interrupts
                      00077         ;               0 = Disables all low priority peripheral interrupts
                      00078         ; bit 5 TMR0IE: TMR0 Overflow Interrupt Enable bit
                      00079         ;       1 = Enables the TMR0 overflow interrupt
                      00080         ;       0 = Disables the TMR0 overflow interrupt
                      00081         ; bit 4 INT0IE: INT0 External Interrupt Enable bit
                      00082         ;       1 = Enables the INT0 external interrupt
                      00083         ;       0 = Disables the INT0 external interrupt
                      00084         ; bit 3 RBIE: RB Port Change Interrupt Enable bit
                      00085         ;       1 = Enables the RB port change interrupt
                      00086         ;       0 = Disables the RB port change interrupt
                      00087         ; bit 2 TMR0IF: TMR0 Overflow Interrupt Flag bit
                      00088         ;       1 = TMR0 register has overflowed (must be cleared in software)
                      00089         ;       0 = TMR0 register did not overflow
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 24
Gestion de 24 servos !

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00090         ; bit 1 INT0IF: INT0 External Interrupt Flag bit
                      00091         ;       1 = The INT0 external interrupt occurred (must be cleared in software)
                      00092         ;       0 = The INT0 external interrupt did not occur
                      00093         ; bit 0 RBIF: RB Port Change Interrupt Flag bit
                      00094         ;       1 = At least one of the RB7:RB4 pins changed state (must be cleared in software)
                      00095         ;       0 = None of the RB7:RB4 pins have changed state
                      00096         MOVLF   b'00100100', INTCON
00044A 0E24               M                 movlw   b'00100100'
00044C 6EF2               M                 movwf   INTCON
                      00097         ;bsf            INTCON, TMR0IF
                      00098 
                      00099         ; INTCON2 Register
                      00100         ; +------+---------+---------+---------+---+--------+---+------+
                      00101         ; | RBPU | INTEDG0 | INTEDG1 | INTEDG2 |  | TMR0IP |  | RBIP |
                      00102         ; +------+---------+---------+---------+---+--------+---+------+
                      00103         ; bit 7 RBPU: PORTB Pull-up Enable bit
                      00104         ;       1 = All PORTB pull-ups are disabled
                      00105         ;       0 = PORTB pull-ups are enabled by individual port latch values
                      00106         ; bit 6 INTEDG0:External Interrupt0 Edge Select bit
                      00107         ;       1 = Interrupt on rising edge
                      00108         ;       0 = Interrupt on falling edge
                      00109         ; bit 5 INTEDG1: External Interrupt1 Edge Select bit
                      00110         ;       1 = Interrupt on rising edge
                      00111         ;       0 = Interrupt on falling edge
                      00112         ; bit 4 INTEDG2: External Interrupt2 Edge Select bit
                      00113         ;       1 = Interrupt on rising edge
                      00114         ;       0 = Interrupt on falling edge
                      00115         ; bit 3 Unimplemented: Read as '1'
                      00116         ; bit 2 TMR0IP: TMR0 Overflow Interrupt Priority bit
                      00117         ;       1 = TMR0 Overflow Interrupt is a high priority event
                      00118         ;       0 = TMR0 Overflow Interrupt is a low priority event
                      00119         ; bit 1 Unimplemented: Read as '1'
                      00120         ; bit 0 RBIP: RB Port Change Interrupt Priority bit
                      00121         ;       1 = RB Port Change Interrupt is a high priority event
                      00122         ;       0 = RB Port Change Interrupt is a low priority event
                      00123         MOVLF   b'10001110', INTCON2
00044E 0E8E               M                 movlw   b'10001110'
000450 6EF1               M                 movwf   INTCON2
                      00124 
                      00125 
                      00126         ; T0CON: TIMER0 CONTROL REGISTER
                      00127         ; +--------+--------+------+------+-----+-------+-------+-------+
                      00128         ; | TMR0ON | T08BIT | T0CS | T0SE | PSA | T0PS2 | T0PS1 | T0PS0 |
                      00129         ; +--------+--------+------+------+-----+-------+-------+-------+
                      00130         ; bit 7 TMR0ON: Timer0 On/Off Control bit
                      00131         ;       1 = Enables Timer0
                      00132         ;       0 = Stops Timer0
                      00133         ; bit 6 T08BIT: Timer0 8-bit/16-bit Control bit
                      00134         ;       1 = Timer0 is configured as an 8-bit timer/counter
                      00135         ;       0 = Timer0 is configured as a 16-bit timer/counter
                      00136         ; bit 5 T0CS: Timer0 Clock Source Select bit
                      00137         ;       1 = Transition on T0CKI pin
                      00138         ;       0 = Internal instruction cycle clock (CLKO)
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 25
Gestion de 24 servos !

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00139         ; bit 4 T0SE: Timer0 Source Edge Select bit
                      00140         ;       1 = Increment on high-to-low transition on T0CKI pin
                      00141         ;       0 = Increment on low-to-high transition on T0CKI pin
                      00142         ; bit 3 PSA: Timer0 Prescaler Assignment bit
                      00143         ;       1 = TImer0 prescaler is NOT assigned. Timer0 clock input bypasses prescaler.
                      00144         ;       0 = Timer0 prescaler is assigned. Timer0 clock input comes from prescaler output.
                      00145         ; bit 2-0 T0PS2:T0PS0: Timer0 Prescaler Select bits
                      00146         ;       111 = 1:256 prescale value
                      00147         ;       110 = 1:128 prescale value
                      00148         ;       101 = 1:64 prescale value 
                      00149         ;       100 = 1:32 prescale value
                      00150         ;       011 = 1:16 prescale value
                      00151         ;       010 = 1:8 prescale value
                      00152         ;       001 = 1:4 prescale value
                      00153         ;       000 = 1:2 prescale value
                      00154 ;       MOVLF   b'10010010', T0CON
                      00155 ;#DEFINE        T0CON_VALUE     b'10010000'
                      00156 ;       MOVLF   T0CON_VALUE, T0CON
                      00157         MOVLF   b'10010000', T0CON
000452 0E90               M                 movlw   b'10010000'
000454 6ED5               M                 movwf   T0CON
                      00158 
                      00159 
                      00160         ; T2CON Register
                      00161         ; +---+---------+---------+---------+---------+--------+---------+---------+
                      00162         ; |      | TOUTPS3 | TOUTPS2 | TOUTPS1 | TOUTPS0 | TMR2ON | T2CKPS1 | T2CKPS0 |
                      00163         ; +---+---------+---------+---------+---------+--------+---------+---------+
                      00164         ; bit 7 Unimplemented: Read as '0'
                      00165         ; bit 6-3 TOUTPS3:TOUTPS0: Timer2 Output Postscale Select bits
                      00166         ; 0000 = 1:1 Postscale
                      00167         ; 0001 = 1:2 Postscale
                      00168         ; 
                      00169         ; 
                      00170         ; 
                      00171         ; 1111 = 1:16 Postscale
                      00172         ; bit 2 TMR2ON: Timer2 On bit
                      00173         ;       1 = Timer2 is on
                      00174         ;       0 = Timer2 is off
                      00175         ; bit 1-0 T2CKPS1:T2CKPS0: Timer2 Clock Prescale Select bits
                      00176         ;       00 = Prescaler is 1
                      00177         ;       01 = Prescaler is 4
                      00178         ;       1x = Prescaler is 16
                      00179         MOVLF   b'00000000', T2CON
000456 0E00               M                 movlw   b'00000000'
000458 6ECA               M                 movwf   T2CON
                      00180 
                      00181 ;       bsf             PIE1, TMR2IE
                      00182 ;       MOVLF   b'11111111', PR2
                      00183 
                      00184 
                      00185         ; T3CON: TIMER3 CONTROL REGISTER
                      00186         ; +------+--------+---------+---------+--------+-------+---------+--------+
                      00187         ; | RD16 | T3CCP2 | T3CKPS1 | T3CKPS0 | T3CCP1 | T3SYN |C TMR3CS | TMR3ON |
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 26
Gestion de 24 servos !

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00188         ; +------+--------+---------+---------+--------+-------+---------+--------+
                      00189         ; bit 7 RD16: 16-bit Read/Write Mode Enable bit
                      00190         ;       1 = Enables register Read/Write of Timer3 in one 16-bit operation
                      00191         ;       0 = Enables register Read/Write of Timer3 in two 8-bit operations
                      00192         ; bit 6-3 T3CCP2:T3CCP1: Timer3 and Timer1 to CCPx Enable bits
                      00193         ;       1x = Timer3 is the clock source for compare/capture CCP modules
                      00194         ;       01 = Timer3 is the clock source for compare/capture of CCP2, Timer1 is the clock source 
                            for compare/capture of CCP1
                      00195         ;       00 = Timer1 is the clock source for compare/capture CCP modules
                      00196         ; bit 5-4 T3CKPS1:T3CKPS0: Timer3 Input Clock Prescale Select bits
                      00197         ;       11 = 1:8 Prescale value
                      00198         ;       10 = 1:4 Prescale value
                      00199         ;       01 = 1:2 Prescale value
                      00200         ;       00 = 1:1 Prescale value
                      00201         ; bit 2 T3SYNC: Timer3 External Clock Input Synchronization Control bit
                      00202         ;       (Not usable if the system clock comes from Timer1/Timer3)
                      00203         ;       When TMR3CS = 1:
                      00204         ;               1 = Do not synchronize external clock input
                      00205         ;               0 = Synchronize external clock input
                      00206         ;       When TMR3CS = 0:
                      00207         ;               This bit is ignored. Timer3 uses the internal clock when TMR3CS = 0.
                      00208         ; bit 1 TMR3CS: Timer3 Clock Source Select bit
                      00209         ;       1 = External clock input from Timer1 oscillator or T1CKI
                      00210         ;               (on the rising edge after the first falling edge)
                      00211         ;       0 = Internal clock (FOSC/4)
                      00212         ; bit 0 TMR3ON: Timer3 On bit
                      00213         ;       1 = Enables Timer3
                      00214         ;       0 = Stops Timer3
                      00215 ;       MOVLF   b'10011000', T3CON
                      00216 
                      00217 ;       bsf             PIE2, TMR3IE
                      00218 ;       bsf             IPR2, TMR3IP
                      00219 
                      00220 
                      00221 
                      00222         ; Set ADCON0
00045A 0E81           00223         movlw   b'10000001'
00045C 6EC2           00224         movwf   ADCON0
                      00225         
                      00226         ; Set ADCON1
00045E 0E80           00227         movlw   b'10000000'
000460 6EC1           00228         movwf   ADCON1
                      00229 
                      00230 
                      00231 
                      00232         MOVLF   b'10100000', T1CON
000462 0EA0               M                 movlw   b'10100000'
000464 6ECD               M                 movwf   T1CON
000466 809D           00233         bsf             PIE1, TMR1IE
000468 809F           00234         bsf             IPR1, TMR1IP
                      00235 
                      00236 
                      00237         ; ##################
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 27
Gestion de 24 servos !

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00046A 0E01           00238         movlw   .1
00046C 6E4F           00239         movwf   phase
                      00240 
00046E 6A50           00241         clrf    phase_cmpt
                      00242 
000470 6A3C           00243         clrf    cmpt_pass
000472 0E80           00244         movlw   .128
000474 6E3D           00245         movwf   current_cons
                      00246 
                      00247 ;       movlw   .1
                      00248 ;       movwf   cmpt_word
000476 6A5F           00249         clrf    received_counter
                      00250 
                      00251 ;       movwf   pos_recept
                      00252         
                      00253 
                      00254         ; Liaison série !
                      00255 ;       #define BAUD  .9600
                      00256 ;       #define XTAL  .4000000
                      00257 ;       #define X     ((XTAL * .1000000) / ( .64 * BAUD)) - 1
                      00258 
                      00259         #define         BAUD    .9600
                      00260         #define         XTAL    .40000000
                      00261         #define         X               ((XTAL / BAUD) / 64) - 1
                      00262 ;       MOVLF   X, SPBRG
                      00263 
                      00264 ;messg X
                      00265 
                      00266         ; 64 : 9600baud OK
                      00267         ;MOVLF  .64, SPBRG
                      00268 
                      00269         ; 32 : 19200baud OK
                      00270         MOVLF   .32, SPBRG
000478 0E20               M                 movlw   .32
00047A 6EAF               M                 movwf   SPBRG
                      00271 
                      00272         ; 7 : 76.8 (78.13)
                      00273         ;MOVLF  .7, SPBRG
                      00274         ;bcf TXSTA, BRGH
                      00275 
                      00276         ; 32 : 19200baud, BRGH = 1
                      00277         ;MOVLF  .129, SPBRG
                      00278         ;bsf            TXSTA, BRGH
                      00279 
                      00280         ; 25 : 96k, BRGH = 1
                      00281         ;MOVLF  .25, SPBRG
                      00282         ;bsf            TXSTA, BRGH
                      00283 
00047C 98AC           00284         bcf             TXSTA, SYNC
                      00285 
00047E 8EAB           00286         bsf             RCSTA, SPEN
000480 9CAB           00287         bcf             RCSTA, RX9
000482 88AB           00288         bsf             RCSTA, CREN
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 28
Gestion de 24 servos !

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00289 
000484 8A9D           00290         bsf             PIE1, RCIE
000486 9A9F           00291         bcf             IPR1, RCIP
                      00292 
                      00293         ; Ajout hugo, le 11/01/2006
                      00294         MOVLF   b'00100001', TXSTA
000488 0E21               M                 movlw   b'00100001'
00048A 6EAC               M                 movwf   TXSTA
                      00295 
00048C 8A9D           00296         bsf             PIE1, RCIE
00048E 989F           00297         bcf             IPR1, TXIP
                      00298         ; Fin ajout hugo
                      00299 
                      00300 ;       clrf    Current_Cmd
                      00301 ;       clrf    Arg_Count
                      00302 ;       clrf    Arg0
                      00303 ;       clrf    Arg1
                      00304 
000490 0E11           00305         movlw   0b00000011
000492 6E4B           00306         movwf   Current_Max_H
                      00307 
000494 0E00           00308         movlw   0b00000000
000496 6E4C           00309         movwf   Current_Max_L
                      00310 
000498 6A4D           00311         clrf    Int_Status
                      00312 
00049A 6A82           00313         clrf    PORTC
                      00868         #include "init2.inc"
                      00001 ; +-----------------------------------------------------------------------------------------------------
                            ------------------------+
                      00002 ; | Gestion de 24 servos avec un PIC18F452                                                              
                                                                                                                            
                      00003 ; | Copyright (C) 2012 Charles RINCHEVAL (contact@digitalspirit.org)                                    
                                                                                                            |
                      00004 ; | Ce programme est libre, vous pouvez le redistribuer et/ou le modifier selon les termes de la Licence
                             Publique Générale GNU  |
                      00005 ; | publiée par la Free Software Foundation (version 2 ou bien toute autre version ultérieure choisie pa
                            r vous).                                |
                      00006 ; | Ce programme est distribué car potentiellement utile, mais SANS AUCUNE GARANTIE, ni explicite ni imp
                            licite,                                 |
                      00007 ; | y compris les garanties de commercialisation ou d'adaptation dans un but spécifique.                
                                                                                            |
                      00008 ; | Reportez-vous à la Licence Publique Générale GNU pour plus de détails.                              
                                                                                                            |
                      00009 ; | Vous devez avoir reçu une copie de la Licence Publique Générale GNU en même temps que ce programme ;
                                                                            |
                      00010 ; | si ce n'est pas le cas,                                                                             
                                                                                                                            
                      00011 ; | écrivez à la Free Software Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307, État
                            s-Unis.                                 |
                      00012 ; +-----------------------------------------------------------------------------------------------------
                            ------------------------+
                      00013 
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 29
Gestion de 24 servos !

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00014 #DEFINE CONS_ALL_0
                      00015 ;#DEFINE        CONS_ALL_1
                      00016 ;#DEFINE        CONS_ALL_254
                      00017 ;#DEFINE        CONS_DEC
                      00018 ;#DEFINE        CONS_INC
                      00019 
                      00020 #IFDEF  CONS_ALL_0
                      00021         MOVLF   .0, servo_cons0         ; 00
00049C 0E00               M                 movlw   .0
00049E 6E00               M                 movwf   servo_cons0
                      00022         MOVLF   .0, servo_cons1         ; 01
0004A0 0E00               M                 movlw   .0
0004A2 6E01               M                 movwf   servo_cons1
                      00023         MOVLF   .0, servo_cons2         ; 02
0004A4 0E00               M                 movlw   .0
0004A6 6E02               M                 movwf   servo_cons2
                      00024         MOVLF   .0, servo_cons3         ; 03
0004A8 0E00               M                 movlw   .0
0004AA 6E03               M                 movwf   servo_cons3
                      00025         MOVLF   .0, servo_cons4         ; 04
0004AC 0E00               M                 movlw   .0
0004AE 6E04               M                 movwf   servo_cons4
                      00026         MOVLF   .0, servo_cons5         ; 05
0004B0 0E00               M                 movlw   .0
0004B2 6E05               M                 movwf   servo_cons5
                      00027         MOVLF   .0, servo_cons6         ; 06
0004B4 0E00               M                 movlw   .0
0004B6 6E06               M                 movwf   servo_cons6
                      00028         MOVLF   .0, servo_cons7         ; 07
0004B8 0E00               M                 movlw   .0
0004BA 6E07               M                 movwf   servo_cons7
                      00029         MOVLF   .0, servo_cons8         ; 08
0004BC 0E00               M                 movlw   .0
0004BE 6E08               M                 movwf   servo_cons8
                      00030         MOVLF   .0, servo_cons9         ; 09
0004C0 0E00               M                 movlw   .0
0004C2 6E09               M                 movwf   servo_cons9
                      00031         MOVLF   .0, servo_cons10        ; 0A
0004C4 0E00               M                 movlw   .0
0004C6 6E0A               M                 movwf   servo_cons10
                      00032         MOVLF   .0, servo_cons11        ; 0B
0004C8 0E00               M                 movlw   .0
0004CA 6E0B               M                 movwf   servo_cons11
                      00033         MOVLF   .0, servo_cons12        ; 0C
0004CC 0E00               M                 movlw   .0
0004CE 6E0C               M                 movwf   servo_cons12
                      00034         MOVLF   .0, servo_cons13        ; 0D
0004D0 0E00               M                 movlw   .0
0004D2 6E0D               M                 movwf   servo_cons13
                      00035         MOVLF   .0, servo_cons14        ; 0E
0004D4 0E00               M                 movlw   .0
0004D6 6E0E               M                 movwf   servo_cons14
                      00036         MOVLF   .0, servo_cons15        ; 0F
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 30
Gestion de 24 servos !

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0004D8 0E00               M                 movlw   .0
0004DA 6E0F               M                 movwf   servo_cons15
                      00037         MOVLF   .0, servo_cons16        ; 10
0004DC 0E00               M                 movlw   .0
0004DE 6E10               M                 movwf   servo_cons16
                      00038         MOVLF   .0, servo_cons17        ; 12
0004E0 0E00               M                 movlw   .0
0004E2 6E11               M                 movwf   servo_cons17
                      00039         MOVLF   .0, servo_cons18        ; 13
0004E4 0E00               M                 movlw   .0
0004E6 6E12               M                 movwf   servo_cons18
                      00040         MOVLF   .0, servo_cons19        ; 14
0004E8 0E00               M                 movlw   .0
0004EA 6E13               M                 movwf   servo_cons19
                      00041         MOVLF   .0, servo_cons20        ; 15
0004EC 0E00               M                 movlw   .0
0004EE 6E14               M                 movwf   servo_cons20
                      00042         MOVLF   .0, servo_cons21        ; 16
0004F0 0E00               M                 movlw   .0
0004F2 6E15               M                 movwf   servo_cons21
                      00043         MOVLF   .0, servo_cons22        ; 17
0004F4 0E00               M                 movlw   .0
0004F6 6E16               M                 movwf   servo_cons22
                      00044         MOVLF   .0, servo_cons23        ; 18
0004F8 0E00               M                 movlw   .0
0004FA 6E17               M                 movwf   servo_cons23
                      00045 #ENDIF
                      00046 
                      00047 #IFDEF  CONS_ALL_1
                      00048         MOVLF   .1, servo_cons0         ; 00
                      00049         MOVLF   .1, servo_cons1         ; 01
                      00050         MOVLF   .1, servo_cons2         ; 02
                      00051         MOVLF   .1, servo_cons3         ; 03
                      00052         MOVLF   .1, servo_cons4         ; 04
                      00053         MOVLF   .1, servo_cons5         ; 05
                      00054         MOVLF   .1, servo_cons6         ; 06
                      00055         MOVLF   .1, servo_cons7         ; 07
                      00056         MOVLF   .1, servo_cons8         ; 08
                      00057         MOVLF   .1, servo_cons9         ; 09
                      00058         MOVLF   .1, servo_cons10        ; 0A
                      00059         MOVLF   .1, servo_cons11        ; 0B
                      00060         MOVLF   .1, servo_cons12        ; 0C
                      00061         MOVLF   .1, servo_cons13        ; 0D
                      00062         MOVLF   .1, servo_cons14        ; 0E
                      00063         MOVLF   .1, servo_cons15        ; 0F
                      00064         MOVLF   .1, servo_cons16        ; 10
                      00065         MOVLF   .1, servo_cons17        ; 12
                      00066         MOVLF   .1, servo_cons18        ; 13
                      00067         MOVLF   .1, servo_cons19        ; 14
                      00068         MOVLF   .1, servo_cons20        ; 15
                      00069         MOVLF   .1, servo_cons21        ; 16
                      00070         MOVLF   .1, servo_cons22        ; 17
                      00071         MOVLF   .1, servo_cons23        ; 18
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 31
Gestion de 24 servos !

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00072 #ENDIF
                      00073 
                      00074 #IFDEF  CONS_ALL_254
                      00075         MOVLF   .254, servo_cons0               ; 00
                      00076         MOVLF   .254, servo_cons1               ; 01
                      00077         MOVLF   .254, servo_cons2               ; 02
                      00078         MOVLF   .254, servo_cons3               ; 03
                      00079         MOVLF   .254, servo_cons4               ; 04
                      00080         MOVLF   .254, servo_cons5               ; 05
                      00081         MOVLF   .254, servo_cons6               ; 06
                      00082         MOVLF   .254, servo_cons7               ; 07
                      00083         MOVLF   .254, servo_cons8               ; 08
                      00084         MOVLF   .254, servo_cons9               ; 09
                      00085         MOVLF   .254, servo_cons10      ; 0A
                      00086         MOVLF   .254, servo_cons11      ; 0B
                      00087         MOVLF   .254, servo_cons12      ; 0C
                      00088         MOVLF   .254, servo_cons13      ; 0D
                      00089         MOVLF   .254, servo_cons14      ; 0E
                      00090         MOVLF   .254, servo_cons15      ; 0F
                      00091         MOVLF   .254, servo_cons16      ; 10
                      00092         MOVLF   .254, servo_cons17      ; 12
                      00093         MOVLF   .254, servo_cons18      ; 13
                      00094         MOVLF   .254, servo_cons19      ; 14
                      00095         MOVLF   .254, servo_cons20      ; 15
                      00096         MOVLF   .254, servo_cons21      ; 16
                      00097         MOVLF   .254, servo_cons22      ; 17
                      00098         MOVLF   .254, servo_cons23      ; 18
                      00099 #ENDIF
                      00100 
                      00101 #IFDEF  CONS_DEC
                      00102         MOVLF   .255, servo_cons0               ; 00
                      00103         MOVLF   .220, servo_cons1               ; 01
                      00104         MOVLF   .210, servo_cons2               ; 02
                      00105         MOVLF   .200, servo_cons3               ; 03
                      00106         MOVLF   .190, servo_cons4               ; 04
                      00107         MOVLF   .180, servo_cons5               ; 05
                      00108         MOVLF   .170, servo_cons6               ; 06
                      00109         MOVLF   .160, servo_cons7               ; 07
                      00110         MOVLF   .150, servo_cons8               ; 08
                      00111         MOVLF   .140, servo_cons9               ; 09
                      00112         MOVLF   .130, servo_cons10      ; 0A
                      00113         MOVLF   .120, servo_cons11      ; 0B
                      00114         MOVLF   .110, servo_cons12      ; 0C
                      00115         MOVLF   .100, servo_cons13      ; 0D
                      00116         MOVLF   .90, servo_cons14       ; 0E
                      00117         MOVLF   .80, servo_cons15       ; 0F
                      00118         MOVLF   .70, servo_cons16       ; 10
                      00119         MOVLF   .60, servo_cons17       ; 12
                      00120         MOVLF   .50, servo_cons18       ; 13
                      00121         MOVLF   .40, servo_cons19       ; 14
                      00122         MOVLF   .30, servo_cons20       ; 15
                      00123         MOVLF   .20, servo_cons21       ; 16
                      00124         MOVLF   .10, servo_cons22       ; 17
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 32
Gestion de 24 servos !

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00125         MOVLF   .1, servo_cons23        ; 18
                      00126 #ENDIF
                      00127 
                      00128 
                      00129 #IFDEF  CONS_INC
                      00130         MOVLF   .1, servo_cons0         ; 00
                      00131         MOVLF   .2, servo_cons1         ; 01
                      00132         MOVLF   .3, servo_cons2         ; 02
                      00133         MOVLF   .4, servo_cons3         ; 03
                      00134         MOVLF   .5, servo_cons4         ; 04
                      00135         MOVLF   .6, servo_cons5         ; 05
                      00136         MOVLF   .7, servo_cons6         ; 06
                      00137         MOVLF   .8, servo_cons7         ; 07
                      00138         MOVLF   .9, servo_cons8         ; 08
                      00139         MOVLF   .10, servo_cons9        ; 09
                      00140         MOVLF   .11, servo_cons10       ; 0A
                      00141         MOVLF   .12, servo_cons11       ; 0B
                      00142         MOVLF   .13, servo_cons12       ; 0C
                      00143         MOVLF   .14, servo_cons13       ; 0D
                      00144         MOVLF   .15, servo_cons14       ; 0E
                      00145         MOVLF   .16, servo_cons15       ; 0F
                      00146         MOVLF   .17, servo_cons16       ; 10
                      00147         MOVLF   .18, servo_cons17       ; 12
                      00148         MOVLF   .19, servo_cons18       ; 13
                      00149         MOVLF   .20, servo_cons19       ; 14
                      00150         MOVLF   .128, servo_cons20      ; 15
                      00151         MOVLF   .129, servo_cons21      ; 16
                      00152         MOVLF   .253, servo_cons22      ; 17
                      00153         MOVLF   .254, servo_cons23      ; 18
                      00154 #ENDIF
                      00155 
                      00156 
0004FC 0101           00157         movlb   .1
                      00158 
                      00159 #IFDEF  CONS_INC
                      00160 
                      00161         MOVLFB  .1, servo_nbr00
                      00162         MOVLFB  .1, servo_nbr01
                      00163         MOVLFB  .1, servo_nbr02
                      00164         MOVLFB  .1, servo_nbr03
                      00165         MOVLFB  .1, servo_nbr04
                      00166         MOVLFB  .1, servo_nbr05
                      00167         MOVLFB  .1, servo_nbr06
                      00168         MOVLFB  .1, servo_nbr07
                      00169         MOVLFB  .1, servo_nbr08
                      00170         MOVLFB  .1, servo_nbr09
                      00171         MOVLFB  .1, servo_nbr10
                      00172         MOVLFB  .1, servo_nbr11
                      00173         MOVLFB  .1, servo_nbr12
                      00174         MOVLFB  .1, servo_nbr13
                      00175         MOVLFB  .1, servo_nbr14
                      00176         MOVLFB  .1, servo_nbr15
                      00177         MOVLFB  .1, servo_nbr16
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 33
Gestion de 24 servos !

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00178         MOVLFB  .1, servo_nbr17
                      00179         MOVLFB  .1, servo_nbr18
                      00180         MOVLFB  .1, servo_nbr19
                      00181         MOVLFB  .1, servo_nbr20
                      00182         MOVLFB  .1, servo_nbr21
                      00183         MOVLFB  .1, servo_nbr22
                      00184         MOVLFB  .1, servo_nbr23
                      00185 
                      00186         MOVLFB  b'00000001', servo_val00
                      00187         MOVLFB  b'00000000', servo_val01                ; 0
                      00188         MOVLFB  b'00000000', servo_val02
                      00189 
                      00190         MOVLFB  b'00000010', servo_val03
                      00191         MOVLFB  b'00000000', servo_val04                ; 1
                      00192         MOVLFB  b'00000000', servo_val05
                      00193 
                      00194         MOVLFB  b'00000100', servo_val06
                      00195         MOVLFB  b'00000000', servo_val07                ; 2
                      00196         MOVLFB  b'00000000', servo_val08
                      00197 
                      00198         MOVLFB  b'00001000', servo_val09
                      00199         MOVLFB  b'00000000', servo_val10                ; 3
                      00200         MOVLFB  b'00000000', servo_val11
                      00201 
                      00202         MOVLFB  b'00010000', servo_val12
                      00203         MOVLFB  b'00000000', servo_val13                ; 4
                      00204         MOVLFB  b'00000000', servo_val14
                      00205 
                      00206         MOVLFB  b'00100000', servo_val15
                      00207         MOVLFB  b'00000000', servo_val16                ; 5
                      00208         MOVLFB  b'00000000', servo_val17
                      00209 
                      00210         MOVLFB  b'01000000', servo_val18
                      00211         MOVLFB  b'00000000', servo_val19                ; 6
                      00212         MOVLFB  b'00000000', servo_val20
                      00213 
                      00214         MOVLFB  b'10000000', servo_val21
                      00215         MOVLFB  b'00000000', servo_val22                ; 7
                      00216         MOVLFB  b'00000000', servo_val23
                      00217 
                      00218         MOVLFB  b'00000000', servo_val24
                      00219         MOVLFB  b'00000001', servo_val25                ; 8
                      00220         MOVLFB  b'00000000', servo_val26
                      00221 
                      00222         MOVLFB  b'00000000', servo_val27
                      00223         MOVLFB  b'00000010', servo_val28                ; 9
                      00224         MOVLFB  b'00000000', servo_val29
                      00225 
                      00226         MOVLFB  b'00000000', servo_val30
                      00227         MOVLFB  b'00000100', servo_val31                ; 10
                      00228         MOVLFB  b'00000000', servo_val32
                      00229 
                      00230         MOVLFB  b'00000000', servo_val33
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 34
Gestion de 24 servos !

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00231         MOVLFB  b'00001000', servo_val34                ; 11
                      00232         MOVLFB  b'00000000', servo_val35
                      00233 
                      00234         MOVLFB  b'00000000', servo_val36
                      00235         MOVLFB  b'00010000', servo_val37                ; 12
                      00236         MOVLFB  b'00000000', servo_val38
                      00237 
                      00238         MOVLFB  b'00000000', servo_val39
                      00239         MOVLFB  b'00100000', servo_val40                ; 13
                      00240         MOVLFB  b'00000000', servo_val41
                      00241 
                      00242         MOVLFB  b'00000000', servo_val42
                      00243         MOVLFB  b'01000000', servo_val43                ; 14
                      00244         MOVLFB  b'00000000', servo_val44
                      00245 
                      00246         MOVLFB  b'00000000', servo_val45
                      00247         MOVLFB  b'10000000', servo_val46                ; 15
                      00248         MOVLFB  b'00000000', servo_val47
                      00249 
                      00250         MOVLFB  b'00000000', servo_val48
                      00251         MOVLFB  b'00000000', servo_val49                ; 16
                      00252         MOVLFB  b'00000001', servo_val50
                      00253 
                      00254         MOVLFB  b'00000000', servo_val51
                      00255         MOVLFB  b'00000000', servo_val52                ; 17
                      00256         MOVLFB  b'00000010', servo_val53
                      00257 
                      00258         MOVLFB  b'00000000', servo_val54
                      00259         MOVLFB  b'00000000', servo_val55                ; 18
                      00260         MOVLFB  b'00000100', servo_val56
                      00261 
                      00262         MOVLFB  b'00000000', servo_val57
                      00263         MOVLFB  b'00000000', servo_val58                ; 19
                      00264         MOVLFB  b'00001000', servo_val59
                      00265 
                      00266         MOVLFB  b'00000000', servo_val60
                      00267         MOVLFB  b'00000000', servo_val61                ; 20
                      00268         MOVLFB  b'00010000', servo_val62
                      00269 
                      00270         MOVLFB  b'00000000', servo_val63
                      00271         MOVLFB  b'00000000', servo_val64                ; 21
                      00272         MOVLFB  b'00100000', servo_val65
                      00273 
                      00274         MOVLFB  b'00000000', servo_val66
                      00275         MOVLFB  b'00000000', servo_val67                ; 22
                      00276         MOVLFB  b'01000000', servo_val68
                      00277 
                      00278         MOVLFB  b'00000000', servo_val69
                      00279         MOVLFB  b'00000000', servo_val70                ; 23
                      00280         MOVLFB  b'10000000', servo_val71
                      00281 
                      00282 #ENDIF
                      00283 
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 35
Gestion de 24 servos !

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00284 #IFDEF  CONS_ALL_0
                      00285 
                      00286         MOVLFB  .23, servo_nbr00
0004FE 0E17               M                 movlw   .23
000500 6F00               M                 movwf   servo_nbr00, BANKED
                      00287         MOVLFB  .0, servo_nbr01
000502 0E00               M                 movlw   .0
000504 6F01               M                 movwf   servo_nbr01, BANKED
                      00288         MOVLFB  .0, servo_nbr02
000506 0E00               M                 movlw   .0
000508 6F02               M                 movwf   servo_nbr02, BANKED
                      00289         MOVLFB  .0, servo_nbr03
00050A 0E00               M                 movlw   .0
00050C 6F03               M                 movwf   servo_nbr03, BANKED
                      00290         MOVLFB  .0, servo_nbr04
00050E 0E00               M                 movlw   .0
000510 6F04               M                 movwf   servo_nbr04, BANKED
                      00291         MOVLFB  .0, servo_nbr05
000512 0E00               M                 movlw   .0
000514 6F05               M                 movwf   servo_nbr05, BANKED
                      00292         MOVLFB  .0, servo_nbr06
000516 0E00               M                 movlw   .0
000518 6F06               M                 movwf   servo_nbr06, BANKED
                      00293         MOVLFB  .0, servo_nbr07
00051A 0E00               M                 movlw   .0
00051C 6F07               M                 movwf   servo_nbr07, BANKED
                      00294         MOVLFB  .0, servo_nbr08
00051E 0E00               M                 movlw   .0
000520 6F08               M                 movwf   servo_nbr08, BANKED
                      00295         MOVLFB  .0, servo_nbr09
000522 0E00               M                 movlw   .0
000524 6F09               M                 movwf   servo_nbr09, BANKED
                      00296         MOVLFB  .0, servo_nbr10
000526 0E00               M                 movlw   .0
000528 6F0A               M                 movwf   servo_nbr10, BANKED
                      00297         MOVLFB  .0, servo_nbr11
00052A 0E00               M                 movlw   .0
00052C 6F0B               M                 movwf   servo_nbr11, BANKED
                      00298         MOVLFB  .0, servo_nbr12
00052E 0E00               M                 movlw   .0
000530 6F0C               M                 movwf   servo_nbr12, BANKED
                      00299         MOVLFB  .0, servo_nbr13
000532 0E00               M                 movlw   .0
000534 6F0D               M                 movwf   servo_nbr13, BANKED
                      00300         MOVLFB  .0, servo_nbr14
000536 0E00               M                 movlw   .0
000538 6F0E               M                 movwf   servo_nbr14, BANKED
                      00301         MOVLFB  .0, servo_nbr15
00053A 0E00               M                 movlw   .0
00053C 6F0F               M                 movwf   servo_nbr15, BANKED
                      00302         MOVLFB  .0, servo_nbr16
00053E 0E00               M                 movlw   .0
000540 6F10               M                 movwf   servo_nbr16, BANKED
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 36
Gestion de 24 servos !

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00303         MOVLFB  .0, servo_nbr17
000542 0E00               M                 movlw   .0
000544 6F11               M                 movwf   servo_nbr17, BANKED
                      00304         MOVLFB  .0, servo_nbr18
000546 0E00               M                 movlw   .0
000548 6F12               M                 movwf   servo_nbr18, BANKED
                      00305         MOVLFB  .0, servo_nbr19
00054A 0E00               M                 movlw   .0
00054C 6F13               M                 movwf   servo_nbr19, BANKED
                      00306         MOVLFB  .0, servo_nbr20
00054E 0E00               M                 movlw   .0
000550 6F14               M                 movwf   servo_nbr20, BANKED
                      00307         MOVLFB  .0, servo_nbr21
000552 0E00               M                 movlw   .0
000554 6F15               M                 movwf   servo_nbr21, BANKED
                      00308         MOVLFB  .0, servo_nbr22
000556 0E00               M                 movlw   .0
000558 6F16               M                 movwf   servo_nbr22, BANKED
                      00309         MOVLFB  .0, servo_nbr23
00055A 0E00               M                 movlw   .0
00055C 6F17               M                 movwf   servo_nbr23, BANKED
                      00310 
                      00311         MOVLFB  b'11111111', servo_val00
00055E 0EFF               M                 movlw   b'11111111'
000560 6F18               M                 movwf   servo_val00, BANKED
                      00312         MOVLFB  b'11111111', servo_val01                ; 0
000562 0EFF               M                 movlw   b'11111111'
000564 6F19               M                 movwf   servo_val01, BANKED
                      00313         MOVLFB  b'11111111', servo_val02
000566 0EFF               M                 movlw   b'11111111'
000568 6F1A               M                 movwf   servo_val02, BANKED
                      00314 
                      00315         MOVLFB  b'00000000', servo_val03
00056A 0E00               M                 movlw   b'00000000'
00056C 6F1B               M                 movwf   servo_val03, BANKED
                      00316         MOVLFB  b'00000000', servo_val04                ; 1
00056E 0E00               M                 movlw   b'00000000'
000570 6F1C               M                 movwf   servo_val04, BANKED
                      00317         MOVLFB  b'00000000', servo_val05
000572 0E00               M                 movlw   b'00000000'
000574 6F1D               M                 movwf   servo_val05, BANKED
                      00318 
                      00319         MOVLFB  b'00000000', servo_val06
000576 0E00               M                 movlw   b'00000000'
000578 6F1E               M                 movwf   servo_val06, BANKED
                      00320         MOVLFB  b'00000000', servo_val07                ; 2
00057A 0E00               M                 movlw   b'00000000'
00057C 6F1F               M                 movwf   servo_val07, BANKED
                      00321         MOVLFB  b'00000000', servo_val08
00057E 0E00               M                 movlw   b'00000000'
000580 6F20               M                 movwf   servo_val08, BANKED
                      00322 
                      00323         MOVLFB  b'00000000', servo_val09
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 37
Gestion de 24 servos !

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000582 0E00               M                 movlw   b'00000000'
000584 6F21               M                 movwf   servo_val09, BANKED
                      00324         MOVLFB  b'00000000', servo_val10                ; 3
000586 0E00               M                 movlw   b'00000000'
000588 6F22               M                 movwf   servo_val10, BANKED
                      00325         MOVLFB  b'00000000', servo_val11
00058A 0E00               M                 movlw   b'00000000'
00058C 6F23               M                 movwf   servo_val11, BANKED
                      00326 
                      00327         MOVLFB  b'00000000', servo_val12
00058E 0E00               M                 movlw   b'00000000'
000590 6F24               M                 movwf   servo_val12, BANKED
                      00328         MOVLFB  b'00000000', servo_val13                ; 4
000592 0E00               M                 movlw   b'00000000'
000594 6F25               M                 movwf   servo_val13, BANKED
                      00329         MOVLFB  b'00000000', servo_val14
000596 0E00               M                 movlw   b'00000000'
000598 6F26               M                 movwf   servo_val14, BANKED
                      00330 
                      00331         MOVLFB  b'00000000', servo_val15
00059A 0E00               M                 movlw   b'00000000'
00059C 6F27               M                 movwf   servo_val15, BANKED
                      00332         MOVLFB  b'00000000', servo_val16                ; 5
00059E 0E00               M                 movlw   b'00000000'
0005A0 6F28               M                 movwf   servo_val16, BANKED
                      00333         MOVLFB  b'00000000', servo_val17
0005A2 0E00               M                 movlw   b'00000000'
0005A4 6F29               M                 movwf   servo_val17, BANKED
                      00334 
                      00335         MOVLFB  b'00000000', servo_val18
0005A6 0E00               M                 movlw   b'00000000'
0005A8 6F2A               M                 movwf   servo_val18, BANKED
                      00336         MOVLFB  b'00000000', servo_val19                ; 6
0005AA 0E00               M                 movlw   b'00000000'
0005AC 6F2B               M                 movwf   servo_val19, BANKED
                      00337         MOVLFB  b'00000000', servo_val20
0005AE 0E00               M                 movlw   b'00000000'
0005B0 6F2C               M                 movwf   servo_val20, BANKED
                      00338 
                      00339         MOVLFB  b'00000000', servo_val21
0005B2 0E00               M                 movlw   b'00000000'
0005B4 6F2D               M                 movwf   servo_val21, BANKED
                      00340         MOVLFB  b'00000000', servo_val22                ; 7
0005B6 0E00               M                 movlw   b'00000000'
0005B8 6F2E               M                 movwf   servo_val22, BANKED
                      00341         MOVLFB  b'00000000', servo_val23
0005BA 0E00               M                 movlw   b'00000000'
0005BC 6F2F               M                 movwf   servo_val23, BANKED
                      00342 
                      00343         MOVLFB  b'00000000', servo_val24
0005BE 0E00               M                 movlw   b'00000000'
0005C0 6F30               M                 movwf   servo_val24, BANKED
                      00344         MOVLFB  b'00000000', servo_val25                ; 8
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 38
Gestion de 24 servos !

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0005C2 0E00               M                 movlw   b'00000000'
0005C4 6F31               M                 movwf   servo_val25, BANKED
                      00345         MOVLFB  b'00000000', servo_val26
0005C6 0E00               M                 movlw   b'00000000'
0005C8 6F32               M                 movwf   servo_val26, BANKED
                      00346 
                      00347         MOVLFB  b'00000000', servo_val27
0005CA 0E00               M                 movlw   b'00000000'
0005CC 6F33               M                 movwf   servo_val27, BANKED
                      00348         MOVLFB  b'00000000', servo_val28                ; 9
0005CE 0E00               M                 movlw   b'00000000'
0005D0 6F34               M                 movwf   servo_val28, BANKED
                      00349         MOVLFB  b'00000000', servo_val29
0005D2 0E00               M                 movlw   b'00000000'
0005D4 6F35               M                 movwf   servo_val29, BANKED
                      00350 
                      00351         MOVLFB  b'00000000', servo_val30
0005D6 0E00               M                 movlw   b'00000000'
0005D8 6F36               M                 movwf   servo_val30, BANKED
                      00352         MOVLFB  b'00000000', servo_val31                ; 10
0005DA 0E00               M                 movlw   b'00000000'
0005DC 6F37               M                 movwf   servo_val31, BANKED
                      00353         MOVLFB  b'00000000', servo_val32
0005DE 0E00               M                 movlw   b'00000000'
0005E0 6F38               M                 movwf   servo_val32, BANKED
                      00354 
                      00355         MOVLFB  b'00000000', servo_val33
0005E2 0E00               M                 movlw   b'00000000'
0005E4 6F39               M                 movwf   servo_val33, BANKED
                      00356         MOVLFB  b'00000000', servo_val34                ; 11
0005E6 0E00               M                 movlw   b'00000000'
0005E8 6F3A               M                 movwf   servo_val34, BANKED
                      00357         MOVLFB  b'00000000', servo_val35
0005EA 0E00               M                 movlw   b'00000000'
0005EC 6F3B               M                 movwf   servo_val35, BANKED
                      00358 
                      00359         MOVLFB  b'00000000', servo_val36
0005EE 0E00               M                 movlw   b'00000000'
0005F0 6F3C               M                 movwf   servo_val36, BANKED
                      00360         MOVLFB  b'00000000', servo_val37                ; 12
0005F2 0E00               M                 movlw   b'00000000'
0005F4 6F3D               M                 movwf   servo_val37, BANKED
                      00361         MOVLFB  b'00000000', servo_val38
0005F6 0E00               M                 movlw   b'00000000'
0005F8 6F3E               M                 movwf   servo_val38, BANKED
                      00362 
                      00363         MOVLFB  b'00000000', servo_val39
0005FA 0E00               M                 movlw   b'00000000'
0005FC 6F3F               M                 movwf   servo_val39, BANKED
                      00364         MOVLFB  b'00000000', servo_val40                ; 13
0005FE 0E00               M                 movlw   b'00000000'
000600 6F40               M                 movwf   servo_val40, BANKED
                      00365         MOVLFB  b'00000000', servo_val41
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 39
Gestion de 24 servos !

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000602 0E00               M                 movlw   b'00000000'
000604 6F41               M                 movwf   servo_val41, BANKED
                      00366 
                      00367         MOVLFB  b'00000000', servo_val42
000606 0E00               M                 movlw   b'00000000'
000608 6F42               M                 movwf   servo_val42, BANKED
                      00368         MOVLFB  b'00000000', servo_val43                ; 14
00060A 0E00               M                 movlw   b'00000000'
00060C 6F43               M                 movwf   servo_val43, BANKED
                      00369         MOVLFB  b'00000000', servo_val44
00060E 0E00               M                 movlw   b'00000000'
000610 6F44               M                 movwf   servo_val44, BANKED
                      00370 
                      00371         MOVLFB  b'00000000', servo_val45
000612 0E00               M                 movlw   b'00000000'
000614 6F45               M                 movwf   servo_val45, BANKED
                      00372         MOVLFB  b'00000000', servo_val46                ; 15
000616 0E00               M                 movlw   b'00000000'
000618 6F46               M                 movwf   servo_val46, BANKED
                      00373         MOVLFB  b'00000000', servo_val47
00061A 0E00               M                 movlw   b'00000000'
00061C 6F47               M                 movwf   servo_val47, BANKED
                      00374 
                      00375         MOVLFB  b'00000000', servo_val48
00061E 0E00               M                 movlw   b'00000000'
000620 6F48               M                 movwf   servo_val48, BANKED
                      00376         MOVLFB  b'00000000', servo_val49                ; 16
000622 0E00               M                 movlw   b'00000000'
000624 6F49               M                 movwf   servo_val49, BANKED
                      00377         MOVLFB  b'00000000', servo_val50
000626 0E00               M                 movlw   b'00000000'
000628 6F4A               M                 movwf   servo_val50, BANKED
                      00378 
                      00379         MOVLFB  b'00000000', servo_val51
00062A 0E00               M                 movlw   b'00000000'
00062C 6F4B               M                 movwf   servo_val51, BANKED
                      00380         MOVLFB  b'00000000', servo_val52                ; 17
00062E 0E00               M                 movlw   b'00000000'
000630 6F4C               M                 movwf   servo_val52, BANKED
                      00381         MOVLFB  b'00000000', servo_val53
000632 0E00               M                 movlw   b'00000000'
000634 6F4D               M                 movwf   servo_val53, BANKED
                      00382 
                      00383         MOVLFB  b'00000000', servo_val54
000636 0E00               M                 movlw   b'00000000'
000638 6F4E               M                 movwf   servo_val54, BANKED
                      00384         MOVLFB  b'00000000', servo_val55                ; 18
00063A 0E00               M                 movlw   b'00000000'
00063C 6F4F               M                 movwf   servo_val55, BANKED
                      00385         MOVLFB  b'00000000', servo_val56
00063E 0E00               M                 movlw   b'00000000'
000640 6F50               M                 movwf   servo_val56, BANKED
                      00386 
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 40
Gestion de 24 servos !

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00387         MOVLFB  b'00000000', servo_val57
000642 0E00               M                 movlw   b'00000000'
000644 6F51               M                 movwf   servo_val57, BANKED
                      00388         MOVLFB  b'00000000', servo_val58                ; 19
000646 0E00               M                 movlw   b'00000000'
000648 6F52               M                 movwf   servo_val58, BANKED
                      00389         MOVLFB  b'00000000', servo_val59
00064A 0E00               M                 movlw   b'00000000'
00064C 6F53               M                 movwf   servo_val59, BANKED
                      00390 
                      00391         MOVLFB  b'00000000', servo_val60
00064E 0E00               M                 movlw   b'00000000'
000650 6F54               M                 movwf   servo_val60, BANKED
                      00392         MOVLFB  b'00000000', servo_val61                ; 20
000652 0E00               M                 movlw   b'00000000'
000654 6F55               M                 movwf   servo_val61, BANKED
                      00393         MOVLFB  b'00000000', servo_val62
000656 0E00               M                 movlw   b'00000000'
000658 6F56               M                 movwf   servo_val62, BANKED
                      00394 
                      00395         MOVLFB  b'00000000', servo_val63
00065A 0E00               M                 movlw   b'00000000'
00065C 6F57               M                 movwf   servo_val63, BANKED
                      00396         MOVLFB  b'00000000', servo_val64                ; 21
00065E 0E00               M                 movlw   b'00000000'
000660 6F58               M                 movwf   servo_val64, BANKED
                      00397         MOVLFB  b'00000000', servo_val65
000662 0E00               M                 movlw   b'00000000'
000664 6F59               M                 movwf   servo_val65, BANKED
                      00398 
                      00399         MOVLFB  b'00000000', servo_val66
000666 0E00               M                 movlw   b'00000000'
000668 6F5A               M                 movwf   servo_val66, BANKED
                      00400         MOVLFB  b'00000000', servo_val67                ; 22
00066A 0E00               M                 movlw   b'00000000'
00066C 6F5B               M                 movwf   servo_val67, BANKED
                      00401         MOVLFB  b'00000000', servo_val68
00066E 0E00               M                 movlw   b'00000000'
000670 6F5C               M                 movwf   servo_val68, BANKED
                      00402 
                      00403         MOVLFB  b'00000000', servo_val69
000672 0E00               M                 movlw   b'00000000'
000674 6F5D               M                 movwf   servo_val69, BANKED
                      00404         MOVLFB  b'00000000', servo_val70                ; 23
000676 0E00               M                 movlw   b'00000000'
000678 6F5E               M                 movwf   servo_val70, BANKED
                      00405         MOVLFB  b'00000000', servo_val71
00067A 0E00               M                 movlw   b'00000000'
00067C 6F5F               M                 movwf   servo_val71, BANKED
                      00406 
                      00407 #ENDIF
                      00408 
00067E 0100           00409         movlb   .0
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 41
Gestion de 24 servos !

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00869 
                      00870 
                      00871 
                      00872         ;movlw  0
                      00873         ;call   setValue
                      00874 
000680 6A5F           00875         clrf    received_counter
000682 6A6F           00876         clrf    pause_mode
                      00877 
                      00878 ; Routine principale
                      00879 
                      00880         ; Activation des interruptions
000684 8EF2           00881         bsf             INTCON, GIEH
000686 8CF2           00882         bsf             INTCON, GIEL
                      00883         ;goto _intl_usart
                      00884 
                      00885         
                      00886 
000688                00887 main
000688 ECAF F003      00888         call    Current_Test
                      00889 
                      00890         ; On boucle temps que 18 octets ne sont pas recu
00068C 0E11           00891         movlw .17
00068E 625F           00892         cpfseq received_counter
000690 EF44 F003      00893         goto main
                      00894 
000694 6A5F           00895         clrf received_counter
                      00896 
                      00897         ; Control received bytes
000696 0E00           00898         movlw 0
000698 2460           00899         addwf pos_0, 0
00069A 2461           00900         addwf pos_1, 0
00069C 2462           00901         addwf pos_2, 0
00069E 2463           00902         addwf pos_3, 0
0006A0 2464           00903         addwf pos_4, 0
0006A2 2465           00904         addwf pos_5, 0
0006A4 2466           00905         addwf pos_6, 0
0006A6 2467           00906         addwf pos_7, 0
0006A8 2468           00907         addwf pos_8, 0
0006AA 2469           00908         addwf pos_9, 0
0006AC 246A           00909         addwf pos_10, 0
0006AE 246B           00910         addwf pos_11, 0
0006B0 246C           00911         addwf pos_12, 0
0006B2 246D           00912         addwf pos_13, 0
                      00913 
0006B4 626E           00914         cpfseq reception_control
0006B6 EF7F F003      00915         goto nack
                      00916 
                      00917 ; Tout est bon, on envoie !
0006BA                00918 ack
                      00919         ; BleuettePi servo mapping
                      00920         ; pos_0  RD2 -> SRV0 
                      00921         ; pos_1  RD3 -> SRV1
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 42
Gestion de 24 servos !

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00922         ; pos_2  RD4 -> SRV2
                      00923         ; pos_3  RD5 -> SRV3
                      00924         ; pos_4  RD6 -> SRV4
                      00925         ; pos_5  RD7 -> SRV5
0006BA C060 F012      00926         movff pos_0, servo_cons18
0006BE C061 F013      00927         movff pos_1, servo_cons19
0006C2 C062 F014      00928         movff pos_2, servo_cons20
0006C6 C063 F015      00929         movff pos_3, servo_cons21
0006CA C064 F016      00930         movff pos_4, servo_cons22
0006CE C065 F017      00931         movff pos_5, servo_cons23
                      00932 
                      00933         ; pos_6  RB0 -> SRV6
                      00934         ; pos_7  RB1 -> SRV7
                      00935         ; pos_8  RB2 -> SRV8
                      00936         ; pos_9  RB3 -> SRV9
                      00937         ; pos_10 RB4 -> SRV10
                      00938         ; pos_11 RB5 -> SRV11
0006D2 C066 F008      00939         movff pos_6, servo_cons8
0006D6 C067 F009      00940         movff pos_7, servo_cons9
0006DA C068 F00A      00941         movff pos_8, servo_cons10
0006DE C069 F00B      00942         movff pos_9, servo_cons11
0006E2 C06A F00C      00943         movff pos_10, servo_cons12
0006E6 C06B F00D      00944         movff pos_11, servo_cons13
                      00945 
                      00946         ; pos_12 RD0 -> SRVX
                      00947         ; pos_13 RD1 -> SRVY
0006EA C06C F010      00948         movff pos_12, servo_cons16
0006EE C06D F011      00949         movff pos_13, servo_cons17
                      00950 
                      00951         SEND 'O'
0006F2 0E4F               M                 movlw   'O'
0006F4 6EAD               M                 movwf   TXREG
0006F6 A89E               M                 btfss   PIR1, TXIF
0006F8 EF7B F003          M                 goto    $ - 2
0006FC D7C5           00952         bra     main
                      00953 
0006FE                00954 nack
                      00955         SEND 'N'
0006FE 0E4E               M                 movlw   'N'
000700 6EAD               M                 movwf   TXREG
000702 A89E               M                 btfss   PIR1, TXIF
000704 EF81 F003          M                 goto    $ - 2
000708 EF44 F003      00956         goto main
                      00957 
                      00958         #include "functions.inc"
                      00001 
00070C                00002 Adc_Read
                      00003         ; Select Input
00070C 0F80           00004         addlw   b'10000000'
00070E 6EC2           00005         movwf   ADCON0
                      00006 
000710 80C2           00007         bsf     ADCON0, ADON
                      00008 
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 43
Gestion de 24 servos !

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00009         ; Acquisition time from scratch
000712 0E20           00010         movlw   20
000714 6E58           00011         movwf   cmpt_bcl
000716                00012 _Adc_Read_Delay
000716 0000           00013         nop
000718 2E58           00014         decfsz  cmpt_bcl
00071A D7FD           00015         bra             _Adc_Read_Delay
                      00016 
                      00017         ; Initiate conversion
00071C 84C2           00018         bsf             ADCON0, GO_DONE
                      00019 
                      00020         ; wait for ADC to finish
00071E                00021 _Adc_Read_Wait
00071E B4C2           00022         btfsc   ADCON0, GO_DONE
000720 EF8F F003      00023         goto    _Adc_Read_Wait
                      00024 
000724 50C4           00025         movf    ADRESH, W
000726 0B03           00026         andlw   0x03
000728 6E47           00027         movwf   Adc_Result_H
00072A 50C3           00028         movf    ADRESL, W
00072C 6E48           00029         movwf   Adc_Result_L
00072E 0012           00030         return
                      00031 
000730                00032 Serial_Send
000730 6EAD           00033         movwf   TXREG
000732 A89E           00034         btfss   PIR1, TXIF
000734 EF99 F003      00035         goto    $ - 2
000738 0012           00036         return
                      00037 
00073A                00038 Serial_Send_Delay
00073A 6EAD           00039         movwf   TXREG
00073C A89E           00040         btfss   PIR1, TXIF
00073E EF9E F003      00041         goto    $ - 2
                      00042 
000742 0EFF           00043         movlw   0xFF
000744 6E58           00044         movwf   cmpt_bcl
000746                00045 _Serial_Send_Delay
000746 D000           00046         bra             $ + 2
000748 D000           00047         bra             $ + 2
00074A D000           00048         bra             $ + 2
00074C D000           00049         bra             $ + 2
00074E D000           00050         bra             $ + 2
000750 D000           00051         bra             $ + 2
000752 D000           00052         bra             $ + 2
000754 D000           00053         bra     $ + 2
000756 D000           00054         bra     $ + 2
000758 2E58           00055         decfsz  cmpt_bcl
00075A D7F5           00056         bra             _Serial_Send_Delay
00075C 0012           00057         return
                      00058 
                      00059 ;Adc_Serial_Send
                      00060 ;       return
                      00061 
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 44
Gestion de 24 servos !

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00075E                00062 Current_Test
                      00063         INT_OFF
00075E 9082               M                 bcf             PORTC, 0
                      00064         ;btfsc  Int_Status, INT_STATUS_MAX_CURRENT_REACHED
                      00065         ;goto   _Current_Test_Exit
                      00066 
                      00067         ; Read current value just before stop port !
                      00068         ;movlw  ADC_AN0;CURRENT_CHANNEL
000760 0E38           00069         movlw   CURRENT_CHANNEL
000762 EC86 F003      00070         call    Adc_Read
000766 C047 F049      00071         movff   Adc_Result_H, Current_Last_H
00076A C048 F04A      00072         movff   Adc_Result_L, Current_Last_L
                      00073 
                      00074         ;movlw  1
                      00075         ;movwf  Current_Max_H
                      00076         ;clrf   Current_Max_L
                      00077 
                      00078         ; Test if upper than max
                      00079         ; 0. Si H = 0 > Goto 4
                      00080         ; 1. Si H > HM > Alert !
                      00081         ; 2. Si H < HM > Exit
                      00082         ; 3. Si H = HM >
                      00083         ; 4.    Si L > LM > Alert
                      00084         ; 5.    Si L < LM > Exit
                      00085         ; 6.    Si L = LM > Alert
                      00086 
                      00087         ; If 0 ? Skip directly to Low nibble test
                      00088         ;tstfsz         Current_Last_H
                      00089         ;bra    $ + 4
                      00090         ;goto   _Current_Test_L
                      00091 
                      00092         ; High nibble test
00076E                00093 _Current_Test_H
00076E 504B           00094         movf    Current_Max_H, W
000770 6049           00095         cpfslt  Current_Last_H
000772 D001           00096         bra             $ + 4
                      00097 
000774 EFD2 F003      00098         goto    _Current_Test_Exit
                      00099 
000778 504B           00100         movf    Current_Max_H, W
00077A 6249           00101         cpfseq  Current_Last_H
00077C D001           00102         bra     $ + 4
                      00103 
00077E EFD0 F003      00104         goto    _Current_Test_Alert
                      00105         ;goto   _Current_Test_L
                      00106 
000782 504B           00107         movf    Current_Max_H, W
000784 6049           00108         cpfslt  Current_Last_H
000786 EFD0 F003      00109         goto    _Current_Test_Alert
                      00110 
                      00111         ; Low nibble test
00078A                00112 _Current_Test_L
                      00113         ;tstfsz         Current_Last_L
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 45
Gestion de 24 servos !

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00114         ;bra    $ + 4
                      00115         ;goto   _Current_Test_Exit
                      00116 
00078A 504C           00117         movf    Current_Max_L, W
00078C 624A           00118         cpfseq  Current_Last_L
00078E D001           00119         bra     $ + 4
000790 EFD0 F003      00120         goto    _Current_Test_Alert
                      00121 
000794 504C           00122         movf    Current_Max_L, W
000796 604A           00123         cpfslt  Current_Last_L
000798 EFD0 F003      00124         goto    _Current_Test_Alert
                      00125 
                      00126         ;cpfslt         Current_Last_L
                      00127         ;goto   _Current_Test_Exit
                      00128 
00079C EFD2 F003      00129         goto    _Current_Test_Exit
                      00130 
0007A0                00131 _Current_Test_Alert
0007A0 804D           00132         bsf     Int_Status, INT_STATUS_MAX_CURRENT_REACHED
                      00133         INT_ON
0007A2 8082               M                 bsf     PORTC, 0
0007A4                00134 _Current_Test_Exit
0007A4 0012           00135         return
                      00959 
                      00960 ; Met toutes les consignes à la valeur voulues (dans WREG)
0007A6                00961 setValue
0007A6 6E00           00962         movwf   servo_cons0
0007A8 6E01           00963         movwf   servo_cons1
0007AA 6E02           00964         movwf   servo_cons2
0007AC 6E03           00965         movwf   servo_cons3
0007AE 6E04           00966         movwf   servo_cons4
0007B0 6E05           00967         movwf   servo_cons5
0007B2 6E06           00968         movwf   servo_cons6
0007B4 6E07           00969         movwf   servo_cons7
                      00970         
0007B6 6E08           00971         movwf   servo_cons8
0007B8 6E09           00972         movwf   servo_cons9
0007BA 6E0A           00973         movwf   servo_cons10
0007BC 6E0B           00974         movwf   servo_cons11
0007BE 6E0C           00975         movwf   servo_cons12
0007C0 6E0D           00976         movwf   servo_cons13
0007C2 6E0E           00977         movwf   servo_cons14
0007C4 6E0F           00978         movwf   servo_cons15
                      00979         
0007C6 6E10           00980         movwf   servo_cons16
0007C8 6E11           00981         movwf   servo_cons17
0007CA 6E12           00982         movwf   servo_cons18
0007CC 6E13           00983         movwf   servo_cons19
0007CE 6E14           00984         movwf   servo_cons20
0007D0 6E15           00985         movwf   servo_cons21
0007D2 6E16           00986         movwf   servo_cons22
0007D4 6E17           00987         movwf   servo_cons23
0007D6 0012           00988         return
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 46
Gestion de 24 servos !

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00989 
0007D8                00990 clearAllOut
0007D8 0EC0           00991         movlw   b'11000000'
0007DA 168A           00992         andwf   LATB, 1
                      00993 
0007DC 6A8C           00994         clrf    LATD
0007DE 0012           00995         return
                      00996 
                      00997 
                      00998 ; Tous les ports des servos à 1 ...
                      00999 ; ... sauf ceux qui ont une consigne à 0
0007E0                01000 setAllPort
                      01001 ; On reprend le principe suivant :
                      01002 ; RA0, RA1, RA2, RA3, RA4, RC0, RC1, RC2 -> Servo 0 à 7
                      01003 ; RB0, RB1, RB2, RB3, RB4, RB5, RE0, RE1 -> Servo 8 à 15
                      01004 ; RD0, RD1, RD2, RD3, RD4, RD5, RD6, RD7 -> Servo 16 à 23
                      01005 ; Inutile de faire une boucle pour gérer le code ci-dessous !
                      01006 
0007E0 6A43           01007         clrf    buf_PORTB
0007E2 6A45           01008         clrf    buf_PORTD
                      01009 
                      01010         ; pos_12 RD0 -> SRVX
                      01011         ; pos_13 RD1 -> SRVY
                      01012 
                      01013         ; pos_0  RD2 -> SRV0
                      01014         ; pos_1  RD3 -> SRV1
                      01015         ; pos_2  RD4 -> SRV2
                      01016         ; pos_3  RD5 -> SRV3
                      01017         ; pos_4  RD6 -> SRV4
                      01018         ; pos_5  RD7 -> SRV5
0007E4 6AE8           01019         clrf    WREG
0007E6 6612           01020         tstfsz  servo_cons18
0007E8 0E04           01021         movlw   b'00000100'
0007EA 1245           01022         iorwf   buf_PORTD
                      01023 
0007EC 6AE8           01024         clrf    WREG
0007EE 6613           01025         tstfsz  servo_cons19
0007F0 0E08           01026         movlw   b'00001000'
0007F2 1245           01027         iorwf   buf_PORTD
                      01028 
0007F4 6AE8           01029         clrf    WREG
0007F6 6614           01030         tstfsz  servo_cons20
0007F8 0E10           01031         movlw   b'00010000'
0007FA 1245           01032         iorwf   buf_PORTD
                      01033 
0007FC 6AE8           01034         clrf    WREG
0007FE 6615           01035         tstfsz  servo_cons21
000800 0E20           01036         movlw   b'00100000'
000802 1245           01037         iorwf   buf_PORTD
                      01038 
000804 6AE8           01039         clrf    WREG
000806 6616           01040         tstfsz  servo_cons22
000808 0E40           01041         movlw   b'01000000'
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 47
Gestion de 24 servos !

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00080A 1245           01042         iorwf   buf_PORTD
                      01043 
00080C 6AE8           01044         clrf    WREG
00080E 6617           01045         tstfsz  servo_cons23
000810 0E80           01046         movlw   b'10000000'
000812 1245           01047         iorwf   buf_PORTD
                      01048 
000814 6AE8           01049         clrf    WREG
000816 6610           01050         tstfsz  servo_cons16
000818 0E01           01051         movlw   b'00000001'
00081A 1245           01052         iorwf   buf_PORTD
                      01053 
00081C 6AE8           01054         clrf    WREG
00081E 6611           01055         tstfsz  servo_cons17
000820 0E02           01056         movlw   b'00000010'
000822 1245           01057         iorwf   buf_PORTD
                      01058 
                      01059         ; pos_6  RB0 -> SRV6
                      01060         ; pos_7  RB1 -> SRV7
                      01061         ; pos_8  RB2 -> SRV8
                      01062         ; pos_9  RB3 -> SRV9
                      01063         ; pos_10 RB4 -> SRV10
                      01064         ; pos_11 RB5 -> SRV11
000824 6AE8           01065         clrf    WREG
000826 6608           01066         tstfsz  servo_cons8
000828 0E01           01067         movlw   b'00000001'
00082A 1243           01068         iorwf   buf_PORTB
                      01069 
00082C 6AE8           01070         clrf    WREG
00082E 6609           01071         tstfsz  servo_cons9
000830 0E02           01072         movlw   b'00000010'
000832 1243           01073         iorwf   buf_PORTB
                      01074 
000834 6AE8           01075         clrf    WREG
000836 660A           01076         tstfsz  servo_cons10
000838 0E04           01077         movlw   b'00000100'
00083A 1243           01078         iorwf   buf_PORTB
                      01079 
00083C 6AE8           01080         clrf    WREG
00083E 660B           01081         tstfsz  servo_cons11
000840 0E08           01082         movlw   b'00001000'
000842 1243           01083         iorwf   buf_PORTB
                      01084 
000844 6AE8           01085         clrf    WREG
000846 660C           01086         tstfsz  servo_cons12
000848 0E10           01087         movlw   b'00010000'
00084A 1243           01088         iorwf   buf_PORTB
                      01089 
00084C 6AE8           01090         clrf    WREG
00084E 660D           01091         tstfsz  servo_cons13
000850 0E20           01092         movlw   b'00100000'
000852 1243           01093         iorwf   buf_PORTB
                      01094 
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 48
Gestion de 24 servos !

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000854 5043           01095         movf    buf_PORTB, W
000856 6E8A           01096         movwf   LATB
000858 5045           01097         movf    buf_PORTD, W
00085A 6E8C           01098         movwf   LATD
                      01099 
00085C 0012           01100         return
                      01101 
                      01102 
                      01103 
                      01104 
                      01105 ; Eteint le port ou les ports spécifiés par le contenu de 3 octets,
                      01106 ; l'adresse du premier des 3 octets étant spécifié dans W
                      01107 ; Les ports utilisés sont A, B, C, D, E, le port C servant
                      01108 ; à recevoir les ordres pour piloter les servos
                      01109 ; x [0;7]       PORTA [0-4], PORTC [0-2]
                      01110 ; x [8;15]      PORTB [0-5], PORTE [1-2]
                      01111 ; x [16;23]     PORTD [0-7]
                      01112 ; RA0, RA1, RA2, RA3, RA4, RC0, RC1, RC2        -> Servo 0 à 7
                      01113 ; RB0, RB1, RB2, RB3, RB4, RB5, RE0, RE1        -> Servo 8 à 15 
                      01114 ; RD0, RD1, RD2, RD3, RD4, RD5, RD6, RD7        -> Servo 16 à 23
00085E                01115 clrPort
                      01116         ; Si la consigne courante est 0
                      01117         ; Le ou les servo(s) restent comme il sont, à 1
00085E 503D           01118         movf    current_cons, W
000860 E023           01119         bz              _clrPort
                      01120 
                      01121         ; Le premier octet concerne
                      01122         ; les port A et C
000862 50E7           01123         movf    INDF1, W
000864 0000           01124         nop;
000866 0000           01125         nop;
000868 0000           01126         nop;
                      01127 ;       andlw   b'000111111'
                      01128 ;       xorwf   LATA, W         ; Pour A
                      01129 ;       movwf   buf_PORTA
                      01130 
00086A 50E7           01131         movf    INDF1, W
00086C 0000           01132         nop;
00086E 0000           01133         nop;
000870 0000           01134         nop;
000872 0000           01135         nop;
000874 0000           01136         nop;
000876 0000           01137         nop;
                      01138 ;       rlncf   WREG
                      01139 ;       rlncf   WREG
                      01140 ;       rlncf   WREG
                      01141 ;       andlw   b'00000111'
                      01142 ;       xorwf   LATC, W         ; Pour C
                      01143 ;       movwf   buf_PORTC
                      01144 
                      01145         ; Le deuxième octet concerne
                      01146         ; les port B et E
000878 50E4           01147         movf    PREINC1, W
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 49
Gestion de 24 servos !

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00087A 0B3F           01148         andlw   b'00111111'
00087C 188A           01149         xorwf   LATB, W         ; Pour B
00087E 6E43           01150         movwf   buf_PORTB
                      01151 
000880 50E6           01152         movf    POSTINC1, W
000882 0000           01153         nop;
000884 0000           01154         nop;
000886 0000           01155         nop;
000888 0000           01156         nop;
00088A 0000           01157         nop;
                      01158 ;       rlncf   WREG
                      01159 ;       rlncf   WREG
                      01160 ;       andlw   b'0000011'
                      01161 ;       xorwf   LATE, W         ; Pour E
                      01162 ;       movwf   buf_PORTE
                      01163 
                      01164         ; Le dernier octet concerne le port D
00088C 50E6           01165         movf    POSTINC1, W
00088E 188C           01166         xorwf   LATD, W         ; Pour D
000890 6E45           01167         movwf   buf_PORTD
                      01168 
                      01169         ; Maintenant, on place tout le contenu des buffers ...
                      01170         ; ... dans les ports qui vont bien, ce qui garanti une synchro idéale
                      01171 ;       movf    buf_PORTA, W
                      01172 ;       movwf   LATA
                      01173 ;       movf    buf_PORTC, W
                      01174 ;       movwf   LATC
000892 0000           01175         nop;
000894 0000           01176         nop;
000896 0000           01177         nop;
000898 0000           01178         nop;
                      01179 
00089A 5043           01180         movf    buf_PORTB, W
00089C 6E8A           01181         movwf   LATB
00089E 0000           01182         nop;
0008A0 0000           01183         nop;
                      01184 ;       movf    buf_PORTE, W
                      01185 ;       movwf   LATE
0008A2 5045           01186         movf    buf_PORTD, W
0008A4 6E8C           01187         movwf   LATD
                      01188 
0008A6 0012           01189         return
                      01190 
                      01191 ; Rattrapage du temps en cas de consigne nul
                      01192 ; Ne surtout pas modifier
0008A8                01193 _clrPort
                      01194 
0008A8 2AE1           01195         incf    FSR1L
0008AA 2AE1           01196         incf    FSR1L
0008AC 2AE1           01197         incf    FSR1L
0008AE 0000           01198         nop
0008B0 0000           01199         nop
0008B2 0000           01200         nop
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 50
Gestion de 24 servos !

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0008B4 0000           01201         nop
0008B6 0000           01202         nop
0008B8 0000           01203         nop
0008BA 0000           01204         nop
                      01205 
0008BC 0000           01206         nop
0008BE 0000           01207         nop
0008C0 0000           01208         nop
0008C2 0000           01209         nop
0008C4 0000           01210         nop
0008C6 0000           01211         nop
0008C8 0000           01212         nop
0008CA 0000           01213         nop
0008CC 0000           01214         nop
0008CE 0000           01215         nop
                      01216 
0008D0 0000           01217         nop
0008D2 0000           01218         nop
0008D4 0000           01219         nop
0008D6 0000           01220         nop
0008D8 0000           01221         nop
0008DA 0000           01222         nop
0008DC 0000           01223         nop
0008DE 0000           01224         nop
0008E0 0000           01225         nop
0008E2 0000           01226         nop
                      01227 
0008E4 0000           01228         nop
0008E6 0000           01229         nop
0008E8 0000           01230         nop
                      01231 
0008EA 0012           01232         return
                      01233 
                      01234 
                      01235 
                      01236 ; Tri !
                      01237 ; TODO: refaire tout le code de tri ci dessous !
                      01238 ; il doit y avoir moyen d'économiser beaucoup de temps CPU...
0008EC                01239 sort
                      01240 
0008EC EE00 F018      01241         lfsr    FSR0, servo_sorted      ; Pointeur des servos triés
0008F0 EE11 F018      01242         lfsr    FSR1, servo_val00       ; Pointeur des ports actifs
0008F4 EE21 F000      01243         lfsr    FSR2, servo_nbr00       ; Pointeur de la quantité courante
                      01244 
0008F8 CFE9 F059      01245         movff   FSR0L, tmp_FSR0L
0008FC CFE2 F05B      01246         movff   FSR1H, tmp_FSR1H
000900 CFE1 F05A      01247         movff   FSR1L, tmp_FSR1L
000904 CFD9 F05C      01248         movff   FSR2L, tmp_FSR2L
                      01249 
000908 6A52           01250         clrf    var_max
                      01251 
00090A 0E18           01252         movlw   NBR_SERVO
00090C 6E58           01253         movwf   cmpt_bcl
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 51
Gestion de 24 servos !

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01254 
00090E                01255 sort_
                      01256 
                      01257         ; Initialisation des variables, pointeurs...
00090E EE00 F000      01258         lfsr    FSR0, servo_cons0       ; Pointeur de consignes
000912 EE10 F055      01259         lfsr    FSR1, buf_tab0          ; Buffer de données
                      01260 
000916 6851           01261         setf    var_min
                      01262 
000918 6A55           01263         clrf    buf_tab0
00091A 6A56           01264         clrf    buf_tab1
00091C 6A57           01265         clrf    buf_tab2
                      01266 
00091E 0E01           01267         movlw   .1
000920 6E5D           01268         movwf   cmpt
000922 6E54           01269         movwf   mask_tmp
                      01270 
000924 6A5E           01271         clrf    bcl
                      01272 
                      01273 ; C'est parti !
000926                01274 _sort
000926 2A5E           01275         incf    bcl
000928 0E19           01276         movlw   NBR_SERVO + 1
00092A 605E           01277         cpfslt  bcl                                     ; Si toutes les consignes y sont passées...
00092C D021           01278         bra             _sort_quit                      ; ... on quitte !
                      01279 
00092E 0E18           01280         movlw   NBR_SERVO
000930 5C58           01281         subwf   cmpt_bcl, W
000932 E003           01282         bz              _sort_last
                      01283 
000934 50EF           01284         movf    INDF0, W                        ; Met la consigne courante dans W ...
000936 6052           01285         cpfslt  var_max                         ; ... et test si elle est supérieur à ...
000938 D013           01286         bra             _sort_paf                       ; ... var_max, on poursuit, sinon, on retourne a
                            u début !
                      01287 
00093A                01288 _sort_last
00093A 50EF           01289         movf    INDF0, W                        ; Met la consigne courante dans W ...
00093C 6251           01290         cpfseq  var_min                         ; Si la consigne courante est égale à var_min ...
00093E D004           01291         bra             _sort_next
                      01292 
000940 5054           01293         movf    mask_tmp, W                     ; ... on va là !
000942 12E7           01294         iorwf   INDF1
                      01295 
000944 2A5D           01296         incf    cmpt
000946 D00C           01297         bra             _sort_paf
                      01298 
000948                01299 _sort_next
000948 6051           01300         cpfslt  var_min                         ; Si la consigne courante est inférieur à var_min ...
00094A D001           01301         bra             _sort_inf
                      01302 
00094C D009           01303         bra             _sort_paf
                      01304 
00094E                01305 _sort_inf
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 52
Gestion de 24 servos !

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00094E 50EF           01306         movf    INDF0, W                        ; ... on file ici !
000950 6E51           01307         movwf   var_min
                      01308 
000952 6A55           01309         clrf    buf_tab0
000954 6A56           01310         clrf    buf_tab1
000956 6A57           01311         clrf    buf_tab2
000958 0E01           01312         movlw   .1
00095A 6E5D           01313         movwf   cmpt
                      01314 
00095C 5054           01315         movf    mask_tmp, W
00095E 12E7           01316         iorwf   INDF1
                      01317 
000960                01318 _sort_paf
000960 90D8           01319         bcf             STATUS, C
000962 3654           01320         rlcf    mask_tmp
000964 A0D8           01321         btfss   STATUS, C
000966 D002           01322         bra             _sort_pif
                      01323 
000968 3654           01324         rlcf    mask_tmp
00096A 2AE1           01325         incf    FSR1L
                      01326 
00096C                01327 _sort_pif
00096C 2AE9           01328         incf    FSR0L
00096E D7DB           01329         bra             _sort
                      01330 
                      01331 
000970                01332 _sort_quit
                      01333 
000970 5051           01334         movf    var_min, W
000972 6E52           01335         movwf   var_max
                      01336 
000974 C059 FFE9      01337         movff   tmp_FSR0L, FSR0L        ; servo_sorted  ->      Pointeur de consignes
000978 C05B FFE2      01338         movff   tmp_FSR1H, FSR1H        ; servo_val00   ->      Pointeur des ports actifs
00097C C05A FFE1      01339         movff   tmp_FSR1L, FSR1L
000980 C05C FFD9      01340         movff   tmp_FSR2L, FSR2L        ; servo_nbr00   ->      Pointeur de la quantité courante
                      01341 
000984 C051 FFEE      01342         movff   var_min, POSTINC0
                      01343 
000988 C055 FFE6      01344         movff   buf_tab0, POSTINC1
00098C C056 FFE6      01345         movff   buf_tab1, POSTINC1
000990 C057 FFE6      01346         movff   buf_tab2, POSTINC1
                      01347 
000994 C05D FFDE      01348         movff   cmpt, POSTINC2
                      01349 
000998 CFE9 F059      01350         movff   FSR0L, tmp_FSR0L        ; Sauvegarde des pointeurs
00099C CFE2 F05B      01351         movff   FSR1H, tmp_FSR1H
0009A0 CFE1 F05A      01352         movff   FSR1L, tmp_FSR1L
0009A4 CFD9 F05C      01353         movff   FSR2L, tmp_FSR2L
                      01354 
0009A8 2E58           01355         decfsz  cmpt_bcl
0009AA D7B1           01356         bra             sort_
                      01357 
0009AC 0012           01358         return
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 53
Gestion de 24 servos !

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01359 
                      01360 
                      01361 
                      01362         END
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 54
Gestion de 24 servos !

SYMBOL TABLE
  LABEL                             VALUE 

A                                 00000000
ACCESS                            00000000
ACKDT                             00000005
ACKEN                             00000004
ACKSTAT                           00000006
ADCON0                            00000FC2
ADCON1                            00000FC1
ADCS0                             00000006
ADCS1                             00000007
ADCS2                             00000006
ADC_AN0                           b'00000000'
ADC_AN1                           b'00001000'
ADC_AN2                           b'00010000'
ADC_AN3                           b'00011000'
ADC_AN4                           b'00100000'
ADC_AN5                           b'00101000'
ADC_AN6                           b'00110000'
ADC_AN7                           b'00111000'
ADDEN                             00000003
ADFM                              00000007
ADIE                              00000006
ADIF                              00000006
ADIP                              00000006
ADON                              00000000
ADRES                             00000FC3
ADRESH                            00000FC4
ADRESL                            00000FC3
AN0                               00000000
AN1                               00000001
AN2                               00000002
AN3                               00000003
AN4                               00000005
AN5                               00000000
AN6                               00000001
AN7                               00000002
Adc_Read                          0000070C
Adc_Result_H                      00000047
Adc_Result_L                      00000048
BANKED                            00000001
BAUD                              .9600
BCLIE                             00000003
BCLIF                             00000003
BCLIP                             00000003
BF                                00000000
BOR                               00000000
BRGH                              00000002
BSR                               00000FE0
C                                 00000000
CCP1                              00000002
CCP1CON                           00000FBD
CCP1IE                            00000002
CCP1IF                            00000002
CCP1IP                            00000002
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 55
Gestion de 24 servos !

SYMBOL TABLE
  LABEL                             VALUE 

CCP1M0                            00000000
CCP1M1                            00000001
CCP1M2                            00000002
CCP1M3                            00000003
CCP1X                             00000005
CCP1Y                             00000004
CCP2A                             00000003
CCP2CON                           00000FBA
CCP2IE                            00000000
CCP2IF                            00000000
CCP2IP                            00000000
CCP2M0                            00000000
CCP2M1                            00000001
CCP2M2                            00000002
CCP2M3                            00000003
CCP2X                             00000005
CCP2Y                             00000004
CCP2_DDRB                         00000003
CCP2_DDRC                         00000001
CCP2_PORTB                        00000003
CCP2_PORTC                        00000001
CCP2_TRISB                        00000003
CCP2_TRISC                        00000001
CCPR1                             00000FBE
CCPR1H                            00000FBF
CCPR1L                            00000FBE
CCPR2                             00000FBB
CCPR2H                            00000FBC
CCPR2L                            00000FBB
CFGS                              00000006
CHS0                              00000003
CHS1                              00000004
CHS2                              00000005
CK                                00000006
CKE                               00000006
CKP                               00000004
CLKO                              00000006
COMMAND_CLEAR                     'C'
COMMAND_CURRENT                   'A'
COMMAND_INIT                      'I'
COMMAND_PAUSE                     'P'
COMMAND_READAN0                   '0'
COMMAND_READAN1                   '1'
COMMAND_READAN2                   '2'
COMMAND_READAN3                   '3'
COMMAND_READAN4                   '4'
COMMAND_READAN5                   '5'
COMMAND_READAN6                   '6'
COMMAND_READAN7                   '7'
COMMAND_RESUME                    'R'
COMMAND_SET                       'S'
COMMAND_SET_MAX                   'M'
COMMAND_STATUS                    'T'
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 56
Gestion de 24 servos !

SYMBOL TABLE
  LABEL                             VALUE 

CONS_ALL_0                        
CREN                              00000004
CS                                00000002
CSRC                              00000007
CURRENT_CHANNEL                   ADC_AN7
Current_Last_H                    00000049
Current_Last_L                    0000004A
Current_Max_H                     0000004B
Current_Max_L                     0000004C
Current_Test                      0000075E
D                                 00000005
DATA_ADDRESS                      00000005
DC                                00000001
DC1B0                             00000004
DC1B1                             00000005
DC2B0                             00000004
DC2B1                             00000005
DCCPX                             00000005
DDRA                              TRISA
DDRB                              TRISB
DDRC                              TRISC
DDRD                              TRISD
DDRE                              TRISE
DOFF                              
DON                               
DONE                              00000002
D_A                               00000005
D_NOT_A                           00000005
EEADR                             00000FA9
EECON1                            00000FA6
EECON2                            00000FA7
EEDATA                            00000FA8
EEIE                              00000004
EEIF                              00000004
EEIP                              00000004
EEPGD                             00000007
FAST                              00000001
FERR                              00000002
FREE                              00000004
FSR0                              00000000
FSR0H                             00000FEA
FSR0L                             00000FE9
FSR1                              00000001
FSR1H                             00000FE2
FSR1L                             00000FE1
FSR2                              00000002
FSR2H                             00000FDA
FSR2L                             00000FD9
GCEN                              00000007
GIE                               00000007
GIEH                              00000007
GIEL                              00000006
GIE_GIEH                          00000007
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 57
Gestion de 24 servos !

SYMBOL TABLE
  LABEL                             VALUE 

GO                                00000002
GO_DONE                           00000002
GO_NOT_DONE                       00000002
HEADER                            0xFF
I2C_DAT                           00000005
I2C_DATA                          00000005
I2C_READ                          00000002
I2C_START                         00000003
I2C_STOP                          00000004
IBF                               00000007
IBOV                              00000005
INDF0                             00000FEF
INDF1                             00000FE7
INDF2                             00000FDF
INT0                              00000000
INT0E                             00000004
INT0F                             00000001
INT0IE                            00000004
INT0IF                            00000001
INT1                              00000001
INT1E                             00000003
INT1F                             00000000
INT1IE                            00000003
INT1IF                            00000000
INT1IP                            00000006
INT1P                             00000006
INT2                              00000002
INT2E                             00000004
INT2F                             00000001
INT2IE                            00000004
INT2IF                            00000001
INT2IP                            00000007
INT2P                             00000007
INTCON                            00000FF2
INTCON1                           00000FF2
INTCON2                           00000FF1
INTCON3                           00000FF0
INTEDG0                           00000006
INTEDG1                           00000005
INTEDG2                           00000004
INT_OFF                           
INT_ON                            
INT_STATUS_MAX_CURRENT_REACHED    0
IPEN                              00000007
IPR1                              00000F9F
IPR2                              00000FA2
IRVST                             00000005
Int_Status                        0000004D
LATA                              00000F89
LATA0                             00000000
LATA1                             00000001
LATA2                             00000002
LATA3                             00000003
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 58
Gestion de 24 servos !

SYMBOL TABLE
  LABEL                             VALUE 

LATA4                             00000004
LATA5                             00000005
LATA6                             00000006
LATB                              00000F8A
LATB0                             00000000
LATB1                             00000001
LATB2                             00000002
LATB3                             00000003
LATB4                             00000004
LATB5                             00000005
LATB6                             00000006
LATB7                             00000007
LATC                              00000F8B
LATC0                             00000000
LATC1                             00000001
LATC2                             00000002
LATC3                             00000003
LATC4                             00000004
LATC5                             00000005
LATC6                             00000006
LATC7                             00000007
LATD                              00000F8C
LATD0                             00000000
LATD1                             00000001
LATD2                             00000002
LATD3                             00000003
LATD4                             00000004
LATD5                             00000005
LATD6                             00000006
LATD7                             00000007
LATE                              00000F8D
LATE0                             00000000
LATE1                             00000001
LATE2                             00000002
LVDCON                            00000FD2
LVDEN                             00000004
LVDIE                             00000002
LVDIF                             00000002
LVDIN                             00000005
LVDIP                             00000002
LVDL0                             00000000
LVDL1                             00000001
LVDL2                             00000002
LVDL3                             00000003
MOVLF                             
MOVLFB                            
Mac                               0000004E
N                                 00000004
NBR_SERVO                         .24
NOT_A                             00000005
NOT_ADDRESS                       00000005
NOT_BOR                           00000000
NOT_DONE                          00000002
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 59
Gestion de 24 servos !

SYMBOL TABLE
  LABEL                             VALUE 

NOT_IPEN                          00000007
NOT_PD                            00000002
NOT_POR                           00000001
NOT_RBPU                          00000007
NOT_RC8                           00000006
NOT_RI                            00000004
NOT_T1SYNC                        00000002
NOT_T3SYNC                        00000002
NOT_TO                            00000003
NOT_TX8                           00000006
NOT_W                             00000002
NOT_WRITE                         00000002
OBF                               00000006
OERR                              00000001
OSC2                              00000006
OSCCON                            00000FD3
OV                                00000003
P                                 00000004
PC                                00000FF9
PCFG0                             00000000
PCFG1                             00000001
PCFG2                             00000002
PCFG3                             00000003
PCL                               00000FF9
PCLATH                            00000FFA
PCLATU                            00000FFB
PD                                00000002
PEIE                              00000006
PEIE_GIEL                         00000006
PEN                               00000002
PGC                               00000006
PGD                               00000007
PGM                               00000005
PHASE_1                           0x00
PHASE_2                           0x01
PHASE_3                           0x02
PHASE_4                           0x03
PIE1                              00000F9D
PIE2                              00000FA0
PIR1                              00000F9E
PIR2                              00000FA1
PLUSW0                            00000FEB
PLUSW1                            00000FE3
PLUSW2                            00000FDB
POR                               00000001
PORTA                             00000F80
PORTB                             00000F81
PORTC                             00000F82
PORTD                             00000F83
PORTE                             00000F84
POSTDEC0                          00000FED
POSTDEC1                          00000FE5
POSTDEC2                          00000FDD
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 60
Gestion de 24 servos !

SYMBOL TABLE
  LABEL                             VALUE 

POSTINC0                          00000FEE
POSTINC1                          00000FE6
POSTINC2                          00000FDE
PR2                               00000FCB
PREINC0                           00000FEC
PREINC1                           00000FE4
PREINC2                           00000FDC
PROD                              00000FF3
PRODH                             00000FF4
PRODL                             00000FF3
PSA                               00000003
PSP0                              00000000
PSP1                              00000001
PSP2                              00000002
PSP3                              00000003
PSP4                              00000004
PSP5                              00000005
PSP6                              00000006
PSP7                              00000007
PSPIE                             00000007
PSPIF                             00000007
PSPIP                             00000007
PSPMODE                           00000004
R                                 00000002
RA0                               00000000
RA1                               00000001
RA2                               00000002
RA3                               00000003
RA4                               00000004
RA5                               00000005
RA6                               00000006
RB0                               00000000
RB1                               00000001
RB2                               00000002
RB3                               00000003
RB4                               00000004
RB5                               00000005
RB6                               00000006
RB7                               00000007
RBIE                              00000003
RBIF                              00000000
RBIP                              00000000
RBPU                              00000007
RC0                               00000000
RC1                               00000001
RC2                               00000002
RC3                               00000003
RC4                               00000004
RC5                               00000005
RC6                               00000006
RC7                               00000007
RC8_9                             00000006
RC9                               00000006
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 61
Gestion de 24 servos !

SYMBOL TABLE
  LABEL                             VALUE 

RCD8                              00000000
RCEN                              00000003
RCIE                              00000005
RCIF                              00000005
RCIP                              00000005
RCON                              00000FD0
RCREG                             00000FAE
RCSTA                             00000FAB
RD                                00000000
RD0                               00000000
RD1                               00000001
RD16                              00000007
RD2                               00000002
RD3                               00000003
RD4                               00000004
RD5                               00000005
RD6                               00000006
RD7                               00000007
RE0                               00000000
RE1                               00000001
RE2                               00000002
READ_WRITE                        00000002
RI                                00000004
RSEN                              00000001
RX                                00000007
RX9                               00000006
RX9D                              00000000
R_NOT_W                           00000002
R_W                               00000002
S                                 00000003
SCK                               00000003
SCL                               00000003
SCS                               00000000
SDA                               00000004
SDI                               00000004
SDO                               00000005
SEN                               00000000
SEND                              
SEND_AD                           
SMP                               00000007
SP0                               00000000
SP1                               00000001
SP2                               00000002
SP3                               00000003
SP4                               00000004
SPBRG                             00000FAF
SPEN                              00000007
SREN                              00000005
SS                                00000005
SSPADD                            00000FC8
SSPBUF                            00000FC9
SSPCON1                           00000FC6
SSPCON2                           00000FC5
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 62
Gestion de 24 servos !

SYMBOL TABLE
  LABEL                             VALUE 

SSPEN                             00000005
SSPIE                             00000003
SSPIF                             00000003
SSPIP                             00000003
SSPM0                             00000000
SSPM1                             00000001
SSPM2                             00000002
SSPM3                             00000003
SSPOV                             00000006
SSPSTAT                           00000FC7
STATUS                            00000FD8
STKFUL                            00000007
STKOVF                            00000007
STKPTR                            00000FFC
STKPTR0                           00000000
STKPTR1                           00000001
STKPTR2                           00000002
STKPTR3                           00000003
STKPTR4                           00000004
STKUNF                            00000006
SWDTE                             00000000
SWDTEN                            00000000
SYNC                              00000004
Serial_Send                       00000730
Serial_Send_Delay                 0000073A
T08BIT                            00000006
T0CKI                             00000004
T0CON                             00000FD5
T0CS                              00000005
T0IE                              00000005
T0IF                              00000002
T0IP                              00000002
T0PS0                             00000000
T0PS1                             00000001
T0PS2                             00000002
T0SE                              00000004
T1CKI                             00000000
T1CKPS0                           00000004
T1CKPS1                           00000005
T1CON                             00000FCD
T1INSYNC                          00000002
T1OSCEN                           00000003
T1OSI                             00000001
T1OSO                             00000000
T1SYNC                            00000002
T2CKPS0                           00000000
T2CKPS1                           00000001
T2CON                             00000FCA
T3CCP1                            00000003
T3CCP2                            00000006
T3CKPS0                           00000004
T3CKPS1                           00000005
T3CON                             00000FB1
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 63
Gestion de 24 servos !

SYMBOL TABLE
  LABEL                             VALUE 

T3INSYNC                          00000002
T3SYNC                            00000002
TABLAT                            00000FF5
TBLPTR                            00000FF6
TBLPTRH                           00000FF7
TBLPTRL                           00000FF6
TBLPTRU                           00000FF8
TMR0                              00000FD6
TMR0H                             00000FD7
TMR0IE                            00000005
TMR0IF                            00000002
TMR0IP                            00000002
TMR0L                             00000FD6
TMR0ON                            00000007
TMR1                              00000FCE
TMR1CS                            00000001
TMR1H                             00000FCF
TMR1IE                            00000000
TMR1IF                            00000000
TMR1IP                            00000000
TMR1L                             00000FCE
TMR1ON                            00000000
TMR2                              00000FCC
TMR2IE                            00000001
TMR2IF                            00000001
TMR2IP                            00000001
TMR2ON                            00000002
TMR3                              00000FB2
TMR3CS                            00000001
TMR3H                             00000FB3
TMR3IE                            00000001
TMR3IF                            00000001
TMR3IP                            00000001
TMR3L                             00000FB2
TMR3ON                            00000000
TO                                00000003
TOS                               00000FFD
TOSH                              00000FFE
TOSL                              00000FFD
TOSU                              00000FFF
TOUTPS0                           00000003
TOUTPS1                           00000004
TOUTPS2                           00000005
TOUTPS3                           00000006
TRISA                             00000F92
TRISA0                            00000000
TRISA1                            00000001
TRISA2                            00000002
TRISA3                            00000003
TRISA4                            00000004
TRISA5                            00000005
TRISA6                            00000006
TRISB                             00000F93
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 64
Gestion de 24 servos !

SYMBOL TABLE
  LABEL                             VALUE 

TRISB0                            00000000
TRISB1                            00000001
TRISB2                            00000002
TRISB3                            00000003
TRISB4                            00000004
TRISB5                            00000005
TRISB6                            00000006
TRISB7                            00000007
TRISC                             00000F94
TRISC0                            00000000
TRISC1                            00000001
TRISC2                            00000002
TRISC3                            00000003
TRISC4                            00000004
TRISC5                            00000005
TRISC6                            00000006
TRISC7                            00000007
TRISD                             00000F95
TRISD0                            00000000
TRISD1                            00000001
TRISD2                            00000002
TRISD3                            00000003
TRISD4                            00000004
TRISD5                            00000005
TRISD6                            00000006
TRISD7                            00000007
TRISE                             00000F96
TRISE0                            00000000
TRISE1                            00000001
TRISE2                            00000002
TRMT                              00000001
TX                                00000006
TX8_9                             00000006
TX9                               00000006
TX9D                              00000000
TXD8                              00000000
TXEN                              00000005
TXIE                              00000004
TXIF                              00000004
TXIP                              00000004
TXREG                             00000FAD
TXSTA                             00000FAC
UA                                00000001
VREFM                             00000002
VREFP                             00000003
W                                 00000000
WCOL                              00000007
WDTCON                            00000FD1
WR                                00000001
WREG                              00000FE8
WREN                              00000002
WRERR                             00000003
X                                 ((XTAL / BAUD) / 64) - 1
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 65
Gestion de 24 servos !

SYMBOL TABLE
  LABEL                             VALUE 

XTAL                              .40000000
Z                                 00000002
_Adc_Read_Delay                   00000716
_Adc_Read_Wait                    0000071E
_BORV_20                          000000FF
_BORV_20_2L                       000000FF
_BORV_27_2L                       000000FB
_BORV_42_2L                       000000F7
_BORV_45_2L                       000000F3
_BOR_OFF_2L                       000000FD
_BOR_ON_2L                        000000FF
_CCP2MX_OFF                       000000FE
_CCP2MX_OFF_3H                    000000FE
_CCP2MX_ON                        000000FF
_CCP2MX_ON_3H                     000000FF
_CONFIG1H                         00300001
_CONFIG2H                         00300003
_CONFIG2L                         00300002
_CONFIG3H                         00300005
_CONFIG4L                         00300006
_CONFIG5H                         00300009
_CONFIG5L                         00300008
_CONFIG6H                         0030000B
_CONFIG6L                         0030000A
_CONFIG7H                         0030000D
_CONFIG7L                         0030000C
_CP0_OFF_5L                       000000FF
_CP0_ON_5L                        000000FE
_CP1_OFF_5L                       000000FF
_CP1_ON_5L                        000000FD
_CP2_OFF_5L                       000000FF
_CP2_ON_5L                        000000FB
_CP3_OFF_5L                       000000FF
_CP3_ON_5L                        000000F7
_CPB_OFF_5H                       000000FF
_CPB_ON_5H                        000000BF
_CPD_OFF_5H                       000000FF
_CPD_ON_5H                        0000007F
_Current_Test_Alert               000007A0
_Current_Test_Exit                000007A4
_Current_Test_H                   0000076E
_Current_Test_L                   0000078A
_DEBUG_OFF_4L                     000000FF
_DEBUG_ON_4L                      0000007F
_DEVID1                           003FFFFE
_DEVID2                           003FFFFF
_EBTR0_OFF_7L                     000000FF
_EBTR0_ON_7L                      000000FE
_EBTR1_OFF_7L                     000000FF
_EBTR1_ON_7L                      000000FD
_EBTR2_OFF_7L                     000000FF
_EBTR2_ON_7L                      000000FB
_EBTR3_OFF_7L                     000000FF
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 66
Gestion de 24 servos !

SYMBOL TABLE
  LABEL                             VALUE 

_EBTR3_ON_7L                      000000F7
_EBTRB_OFF_7H                     000000FF
_EBTRB_ON_7H                      000000BF
_ECIO_OSC                         000000FD
_ECIO_OSC_1H                      000000FD
_EC_OSC                           000000FC
_EC_OSC_1H                        000000FC
_HSPLL_OSC                        000000FE
_HSPLL_OSC_1H                     000000FE
_HS_OSC                           000000FA
_HS_OSC_1H                        000000FA
_IDLOC0                           00200000
_IDLOC1                           00200001
_IDLOC2                           00200002
_IDLOC3                           00200003
_IDLOC4                           00200004
_IDLOC5                           00200005
_IDLOC6                           00200006
_IDLOC7                           00200007
_LP_OSC                           000000F8
_LP_OSC_1H                        000000F8
_LVP_OFF_4L                       000000FB
_LVP_ON_4L                        000000FF
_OSCS_OFF_1H                      000000FF
_OSCS_ON_1H                       000000DF
_PWRT_OFF_2L                      000000FF
_PWRT_ON_2L                       000000FE
_RCIO_OSC                         000000FF
_RCIO_OSC_1H                      000000FF
_RC_OSC                           000000FB
_RC_OSC_1H                        000000FB
_STVR_OFF_4L                      000000FE
_STVR_ON_4L                       000000FF
_Serial_Send_Delay                00000746
_WDTPS_128_2H                     000000FF
_WDTPS_16_2H                      000000F9
_WDTPS_1_2H                       000000F1
_WDTPS_2_2H                       000000F3
_WDTPS_32_2H                      000000FB
_WDTPS_4_2H                       000000F5
_WDTPS_64_2H                      000000FD
_WDTPS_8_2H                       000000F7
_WDT_OFF_2H                       000000FE
_WDT_ON_2H                        000000FF
_WRT0_OFF_6L                      000000FF
_WRT0_ON_6L                       000000FE
_WRT1_OFF_6L                      000000FF
_WRT1_ON_6L                       000000FD
_WRT2_OFF_6L                      000000FF
_WRT2_ON_6L                       000000FB
_WRT3_OFF_6L                      000000FF
_WRT3_ON_6L                       000000F7
_WRTB_OFF_6H                      000000FF
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 67
Gestion de 24 servos !

SYMBOL TABLE
  LABEL                             VALUE 

_WRTB_ON_6H                       000000BF
_WRTC_OFF_6H                      000000FF
_WRTC_ON_6H                       000000DF
_WRTD_OFF_6H                      000000FF
_WRTD_ON_6H                       0000007F
_XT_OSC                           000000F9
_XT_OSC_1H                        000000F9
__18F452                          00000001
_clrPort                          000008A8
_init                             0000041E
_int1_usart_clear                 00000236
_int1_usart_received_send_ack     0000021E
_int1_usart_received_test_ana0    000000D6
_int1_usart_received_test_ana1    000000FC
_int1_usart_received_test_ana2    00000122
_int1_usart_received_test_ana3    00000148
_int1_usart_received_test_ana4    0000016E
_int1_usart_received_test_ana5    00000194
_int1_usart_received_test_ana6    000001BA
_int1_usart_received_test_ana7    000001E0
_int1_usart_received_test_clear   0000020A
_int1_usart_received_test_cur     0000009C
_int1_usart_received_test_init    00000068
_int1_usart_received_test_pause   0000007C
_int1_usart_received_test_resume  0000008E
_int1_usart_received_test_set     0000005C
_int1_usart_received_test_stat    000000BC
_inth_Timer                       00000328
_intl_usart                       0000003E
_intl_usart_end                   00000320
_intl_usart_exit                  00000322
_intl_usart_received_test_cmd     00000054
_intl_usart_received_test_ctrl    0000031C
_intl_usart_received_test_pos0    0000023C
_intl_usart_received_test_pos1    0000024C
_intl_usart_received_test_pos10   000002DC
_intl_usart_received_test_pos11   000002EC
_intl_usart_received_test_pos12   000002FC
_intl_usart_received_test_pos13   0000030C
_intl_usart_received_test_pos2    0000025C
_intl_usart_received_test_pos3    0000026C
_intl_usart_received_test_pos4    0000027C
_intl_usart_received_test_pos5    0000028C
_intl_usart_received_test_pos6    0000029C
_intl_usart_received_test_pos7    000002AC
_intl_usart_received_test_pos8    000002BC
_intl_usart_received_test_pos9    000002CC
_intl_usart_unknow_command        0000022C
_sort                             00000926
_sort_inf                         0000094E
_sort_last                        0000093A
_sort_next                        00000948
_sort_paf                         00000960
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 68
Gestion de 24 servos !

SYMBOL TABLE
  LABEL                             VALUE 

_sort_pif                         0000096C
_sort_quit                        00000970
ack                               000006BA
bcl                               0000005E
bcl_toto                          00000344
buf_PORTA                         00000042
buf_PORTB                         00000043
buf_PORTC                         00000044
buf_PORTD                         00000045
buf_PORTE                         00000046
buf_tab0                          00000055
buf_tab1                          00000056
buf_tab2                          00000057
clearAllOut                       000007D8
clrPort                           0000085E
cmpt                              0000005D
cmpt_bcl                          00000058
cmpt_pass                         0000003C
cons_prec                         00000041
csaving_IN_FSR2H                  00000072
csaving_IN_FSR2L                  00000071
csaving_OUT_FSR2H                 00000074
csaving_OUT_FSR2L                 00000073
current_cons                      0000003D
current_qnt                       0000003F
current_servo                     0000003E
inth                              0000001C
inth_end                          00000418
intl                              00000036
main                              00000688
mask                              00000053
mask_tmp                          00000054
nack                              000006FE
pause_mode                        0000006F
phase                             0000004F
phase2                            000003C8
phase3                            000003EE
phase4                            00000404
phase_cmpt                        00000050
pos_0                             00000060
pos_1                             00000061
pos_10                            0000006A
pos_11                            0000006B
pos_12                            0000006C
pos_13                            0000006D
pos_2                             00000062
pos_3                             00000063
pos_4                             00000064
pos_5                             00000065
pos_6                             00000066
pos_7                             00000067
pos_8                             00000068
pos_9                             00000069
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 69
Gestion de 24 servos !

SYMBOL TABLE
  LABEL                             VALUE 

received_counter                  0000005F
reception_control                 0000006E
servo_cons0                       00000000
servo_cons1                       00000001
servo_cons10                      0000000A
servo_cons11                      0000000B
servo_cons12                      0000000C
servo_cons13                      0000000D
servo_cons14                      0000000E
servo_cons15                      0000000F
servo_cons16                      00000010
servo_cons17                      00000011
servo_cons18                      00000012
servo_cons19                      00000013
servo_cons2                       00000002
servo_cons20                      00000014
servo_cons21                      00000015
servo_cons22                      00000016
servo_cons23                      00000017
servo_cons3                       00000003
servo_cons4                       00000004
servo_cons5                       00000005
servo_cons6                       00000006
servo_cons7                       00000007
servo_cons8                       00000008
servo_cons9                       00000009
servo_nbr00                       00000100
servo_nbr01                       00000101
servo_nbr02                       00000102
servo_nbr03                       00000103
servo_nbr04                       00000104
servo_nbr05                       00000105
servo_nbr06                       00000106
servo_nbr07                       00000107
servo_nbr08                       00000108
servo_nbr09                       00000109
servo_nbr10                       0000010A
servo_nbr11                       0000010B
servo_nbr12                       0000010C
servo_nbr13                       0000010D
servo_nbr14                       0000010E
servo_nbr15                       0000010F
servo_nbr16                       00000110
servo_nbr17                       00000111
servo_nbr18                       00000112
servo_nbr19                       00000113
servo_nbr20                       00000114
servo_nbr21                       00000115
servo_nbr22                       00000116
servo_nbr23                       00000117
servo_sorted                      00000018
servo_val00                       00000118
servo_val01                       00000119
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 70
Gestion de 24 servos !

SYMBOL TABLE
  LABEL                             VALUE 

servo_val02                       0000011A
servo_val03                       0000011B
servo_val04                       0000011C
servo_val05                       0000011D
servo_val06                       0000011E
servo_val07                       0000011F
servo_val08                       00000120
servo_val09                       00000121
servo_val10                       00000122
servo_val11                       00000123
servo_val12                       00000124
servo_val13                       00000125
servo_val14                       00000126
servo_val15                       00000127
servo_val16                       00000128
servo_val17                       00000129
servo_val18                       0000012A
servo_val19                       0000012B
servo_val20                       0000012C
servo_val21                       0000012D
servo_val22                       0000012E
servo_val23                       0000012F
servo_val24                       00000130
servo_val25                       00000131
servo_val26                       00000132
servo_val27                       00000133
servo_val28                       00000134
servo_val29                       00000135
servo_val30                       00000136
servo_val31                       00000137
servo_val32                       00000138
servo_val33                       00000139
servo_val34                       0000013A
servo_val35                       0000013B
servo_val36                       0000013C
servo_val37                       0000013D
servo_val38                       0000013E
servo_val39                       0000013F
servo_val40                       00000140
servo_val41                       00000141
servo_val42                       00000142
servo_val43                       00000143
servo_val44                       00000144
servo_val45                       00000145
servo_val46                       00000146
servo_val47                       00000147
servo_val48                       00000148
servo_val49                       00000149
servo_val50                       0000014A
servo_val51                       0000014B
servo_val52                       0000014C
servo_val53                       0000014D
servo_val54                       0000014E
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 71
Gestion de 24 servos !

SYMBOL TABLE
  LABEL                             VALUE 

servo_val55                       0000014F
servo_val56                       00000150
servo_val57                       00000151
servo_val58                       00000152
servo_val59                       00000153
servo_val60                       00000154
servo_val61                       00000155
servo_val62                       00000156
servo_val63                       00000157
servo_val64                       00000158
servo_val65                       00000159
servo_val66                       0000015A
servo_val67                       0000015B
servo_val68                       0000015C
servo_val69                       0000015D
servo_val70                       0000015E
servo_val71                       0000015F
setAllPort                        000007E0
setValue                          000007A6
sort                              000008EC
sort_                             0000090E
tmp_FSR0L                         00000059
tmp_FSR1H                         0000005B
tmp_FSR1L                         0000005A
tmp_FSR2L                         0000005C
total_qnt                         00000040
var_max                           00000052
var_min                           00000051
wreg_backup                       00000070


MEMORY USAGE MAP ('X' = Used,  '-' = Unused)

0000 : XXXX----XXXX---- --------XXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0040 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0080 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
00C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0100 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0140 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0180 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
01C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0200 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0240 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0280 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
02C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0300 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
MPASM  5.48                          MAIN.ASM   10-8-2013  19:14:41         PAGE 72
Gestion de 24 servos !

MEMORY USAGE MAP ('X' = Used,  '-' = Unused)


0340 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0380 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
03C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0400 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0440 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0480 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
04C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0500 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0540 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0580 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
05C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0600 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0640 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0680 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
06C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0700 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0740 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0780 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
07C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0800 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0840 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0880 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
08C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0900 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0940 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0980 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXX-- ----------------
0000 : XXXX--XXXXXXXX-- ---------------- ---------------- ----------------

All other memory blocks unused.

Program Memory Bytes Used:  2474
Program Memory Bytes Free: 30294


Errors   :     0
Warnings :     7 reported,     0 suppressed
Messages :     0 reported,     0 suppressed

